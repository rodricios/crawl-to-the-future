/* $Id: */
var NYTD=NYTD||{};NYTD.require("/js/app/lib/NYTD/jsonpfeed/jsonp-feed.js");NYTD.Swipe={
init:function(){this.Next=false;this.Prev=false;this.FeedUrl="";var pt=this.getPageType();if(pt=="article"){this.isArticle();}if(pt=="post"){this.isBlog();}if(pt=="best-seller lists"){this.isBestSellersList();}},
isBlog:function(){var h=$$("head")[0];var s=h.select("link[rel=\"start\"]")[0];var p=h.select("link[rel=\"prev\"]")[0];var n=h.select("link[rel=\"next\"]")[0];this.Prev=(p)?p.href:s.href;this.Next=(n)?n.href:s.href;this.addSwipe();},
isArticle:function(){var _6=this;var _7=document.referrer;var _8=/.+nytimes\.com\/pages\/.+\/index\.html/.test(_7);if(_8&&_7.indexOf("pages/todayspaper")==-1){feedUrl=_7.replace(".html",".jsonp").replace(/http:\/\/.+\.nytimes\.com/,NYTD.Hosts.jsonHost);}else{var _9=window.location.search.toQueryParams().feedurl||"";var _a=$$("head meta[name=sectionfront_jsonp]")[0];var _b=_a&&_a.readAttribute("content");feedUrl=_9||_b||"";}var _c=function(_d){var _e=_d.items,_f=_e.length;rankNext=0;rankPrev=0;var _10=$$("head link[rel=canonical]")[0].readAttribute("href");for(var i=0;i<_f;i++){if(_e[i].guid.indexOf(_10)!==-1){_6.Next=_e[((_f-1==i)?0:i+1)].guid;_6.Prev=_e[((0==i)?_f-1:i-1)].guid;break;}}if(!_6.Next){_6.Next=_e[0].guid;}if(!_6.Prev){_6.Prev=_e[0].guid;}_6.addSwipe();};if(feedUrl){this.FeedUrl="#"+feedUrl;new NYTD.JsonpFeed(feedUrl,{onSuccess:_c,onFailure:function(){var _12=NYTD.Hosts.jsonHost+"/pages/index.jsonp";new NYTD.JsonpFeed(_12,{onSuccess:_c});}});}},
isBestSellersList:function(){var _13=$("bestsellersPreviousList");var _14=$("bestsellersNextList");this.Prev=_13.down("a").getAttribute("href");this.Next=_14.down("a").getAttribute("href");this.addSwipe();},
getPageType:function(){var _15=$$("meta[name=\"PT\"]")[0];var _16=false;var _17;if(_15!=_17){_16=_15.getAttribute("content").toLowerCase();if(_16=="blogs"){var _18=$$("meta[name=\"PST\"]")[0];if(_18!=_17){_16=false;var _19=_18.getAttribute("content").toLowerCase();if(_19=="blog main"){_16="blog";}if(_19=="blog post"){_16="post";}}}if(_16=="multimedia"){var _18=$$("meta[name=\"PST\"]")[0];if(_18!=_17){_16=_18.getAttribute("content").toLowerCase();}}if(_16=="reference"){var _1a=$$("meta[name=\"SCG\"]")[0];if(_1a!=_17){_16=_1a.getAttribute("content").toLowerCase();}}}return _16;},
addSwipe:function(){var sh=$("shell");if(this.Next&&this.Prev&&sh){var _1c=this;var _1d=parseInt((window.innerWidth/screen.width*((/android/gi).test(navigator.appVersion)?400:230)),10);var _1e=parseInt((_1d/2),10);this.Swipe={startX:0,startY:0,swipeLength:_1d,
touchStart:function(e){_1c.Swipe.startX=e.touches[0].pageX;_1c.Swipe.startY=e.touches[0].pageY;_1c.Swipe.hasStarted=true;},
touchMove:function(e){var _21=(e.touches[0].pageX-_1c.Swipe.startX);var _22=(e.touches[0].pageY-_1c.Swipe.startY);if(_1c.Swipe.hasStarted&&(_22<_1e&&_22>(_1e*-1))){if(_21>_1c.Swipe.swipeLength&&_1c.Prev){self.location=_1c.Prev+_1c.FeedUrl;}if(_21<-_1c.Swipe.swipeLength&&_1c.Next){self.location=_1c.Next+_1c.FeedUrl;}}}};sh.addEventListener("touchstart",this.Swipe.touchStart,false);sh.addEventListener("touchmove",this.Swipe.touchMove,false);}}};
if((typeof document.ontouchmove=="object"||location.hash.indexOf("isTouch")>0)&&location.host.indexOf("lens.blogs")!=0){Event.observe(window,"load",function(){NYTD.Swipe.init();});}
