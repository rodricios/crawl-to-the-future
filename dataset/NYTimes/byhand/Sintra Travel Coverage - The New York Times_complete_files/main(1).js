define("shared/ad/models/ad",["backbone/nyt"],function(e){var t=e.Model.extend({});return t}),define("shared/ad/collections/ads",["backbone/nyt","underscore/nyt","foundation/collections/base-collection","foundation/hosts","shared/ad/models/ad"],function(e,t,s,i,n){var a=s.extend({deliveryProofParams:["adxforce","debug"],adForceLookup:{leaderboard:"728x90testnyt5",billboard:"970x90horiztest",pushdown:"testnyt5pushdown",halfpage:"mediamindhalfexptest",xxl:"nyt5xxltestpickletag",bigad:"middlerighttest"},initialize:function(e,s){return s?(this.options=s,t.isUndefined(this.pageManager.getMeta("adxPage"))?this.host=this.pageManager.getUrlParam("adx_campaign")||s.adx_campaign||"www.nytimes.com":(this.host="",this.options.page=this.pageManager.getMeta("adxPage")),this.interstitial=s.interstitial?1:0,this.setPageParameter(),void 0):!1},setPageParameter:function(){var e;this.options.page||(e=location.pathname,e=e.replace(/\d{4}/,"yr").replace(/\d{2}/,"mo").replace(/\d{2}/,"day"),this.options.page=this.host+e)},model:n,url:i.adx+"/adx/bin/adxrun.html",sync:function(s,i,n){var a=this,o=["nyt5"];return n.dataType="jsonp",n.jsonp="jsonp",n.data={page:a.options.page,positions:a.options.positions.join(","),autoconfirm:a.options.autoconfirm||0,v:3,cpp:1,attributes:"nyt5",interstitials:this.interstitial},this.options.cpp===!1&&(delete n.data.interstitials,delete n.data.cpp),n.data=a.assignDeliveryProofParams(n.data),"undefined"!=typeof this.pageManager.getUrlParam("hp")&&o.push("hp"),"undefined"!=typeof this.pageManager.getUrlParam("src")&&o.push("src-"+this.pageManager.getUrlParam("src")),"undefined"!=typeof a.options.keywords&&(o=t.union(o,a.chainKeywords(a.options.keywords))),n.data.keywords=t.filter(o,function(e){return!("undefined"==typeof e||""===e)}).join(","),e.sync(s,i,n)},assignDeliveryProofParams:function(e){for(var s,i={},n=this.deliveryProofParams.length-1;n>=0;n-=1)s=this.pageManager.getUrlParam(this.deliveryProofParams[n]),"undefined"!=typeof s&&(i[this.deliveryProofParams[n]]=s||"1");return t.extend(e,i)},chainKeywords:function(e){var t,s,i=e.length,n=[],a=this;for(t=0;i>t;t+=1)s=a.adForceLookup[e[t]],n.push(s||e[t]);return"1"===this.pageManager.getUrlParam("rico")&&n.push(this.pageManager.getUrlParam("keywords")),n},parse:function(e){var s=e.ads;return s=t.map(s,function(e,t){var s=e.isInlineSafe;return e.name=t,e.isInlineSafe="Y"===s||"true"===s,e}),"undefined"!=typeof this.pageManager.getUrlParam("debug")&&(window.adx_debug_output=e,console.log("adx debug page: ",this.options.page),console.log("adx debug positions: ",this.options.positions.join(",")),console.log("adx debug output: ",e),console.log("adx debug keywords: ",this.chainKeywords(this.options.keywords).join(","))),s},getConfirmPixel:function(){return this.confirmPixel?this.confirmPixel.creative:void 0}});return a}),define("shared/ad/templates",["underscore/nyt"],function(_){var templates={};return templates.iFrameStyleSheet=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<style type="text/css">\nbody {\nmargin: 0;\noverflow: hidden;\n}a img {\nborder: none;\n}\n</style>';return __p},templates.interstitialModal=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div id="Interstitial" class="ad interstitial-ad"></div><p class="user-action dismiss-button">Continue &raquo;</p>';return __p},templates.ribbonInterstitial=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="ribbon-interstitial-ad-overlay">\n<h4 class="ad-heading"> Advertisement </h4>\n<div id="RibbonInterstitial" class="ad ribbon-interstitial-ad"> </div>\n</div>';return __p},templates}),define("shared/modal/templates",["underscore/nyt"],function(_){var templates={};return templates.modal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="overlay"></div>\n<div class="modal '+(null==(__t=id)?"":__t)+" "+(null==(__t=addlClasses)?"":__t)+'" style="'+(null==(__t=modalStyles)?"":__t)+'" role="dialog" aria-labelledby="'+(null==(__t=id)?"":__t)+'-modal-heading" tabindex="-1">\n<div class="modal-header">\n<h3 class="modal-heading" id="'+(null==(__t=id)?"":__t)+'-modal-heading">'+(null==(__t=modalTitle)?"":__t)+"</h3>\n"+(null==(__t=headerContent)?"":__t)+'\n</div>\n<div class="modal-content">\n'+(null==(__t=modalContent)?"":__t)+'\n</div>\n<button type="button" class="modal-close '+(null==(__t=closeClass)?"":__t)+'" aria-disabled="false"><i class="icon"></i><span class="visually-hidden">Close this modal window</span></button>\n<div class="modal-pointer '+(null==(__t="modal-pointer-"+tailDirection)?"":__t)+'"><div class="modal-pointer-conceal"></div></div>\n</div>';return __p},templates}),define("shared/modal/views/modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/templates"],function(e,t,s,i){var n=s.registerView("modal").extend({template:i.modal,className:"modal-container",events:{"click .modal-close, .modal-pointer, .dismiss-button":"close","mouseenter .modal":"handleMouseOutClose"},defaultSettings:{id:"default-modal",modalTitle:"",headerContent:"",modalContent:"",addlClasses:"",binding:"",disableBindings:!1,tailDirection:"down",tailTopOffset:0,tailLeftOffset:0,fixedOverride:!1,hasOverlay:!1,hasCloseButton:!1,canOpenOnHover:!1,closeOnMouseOut:!1,mouseOutDelay:0,mouseEnterDelay:0,closeOnClick:!0,autoPosition:!1,positionTailSide:!1,toggleSpeed:300,focusOnShow:!0},initialize:function(e){t.bindAll(this,"close","open","mouseEnterOpen","mouseOutClose","handleClickClose","removeFromPage"),this.settings=t.extend({},this.defaultSettings,e),this.settings.modalStyles="width: "+e.width+";",this.render()},render:function(){var e=this.settings.id+"-container";return this.settings.closeClass=this.settings.hasCloseButton?"":"hidden",this.$el.hide().addClass(e).html(this.template(this.settings)),this.$modal=this.$el.find(".modal"),this.$el.find(".overlay").toggle(this.settings.hasOverlay),this},addToPage:function(e,t){var s="string"==typeof e?this.$body.find(e):this.$body;return t="function"==typeof s[t]?t:"append",s[t](this.$el),""===this.settings.binding||this.settings.disableBindings||(this.$body.on("click",this.settings.binding,this.open),this.settings.canOpenOnHover&&(this.$body.on("mouseenter",this.settings.binding,this.mouseEnterOpen),this.$body.on("mouseleave",this.settings.binding,this.mouseOutClose))),this},removeFromPage:function(){return this.close(),this.$el.remove(),""===this.settings.binding||this.settings.disableBindings||(this.$body.off("click",this.settings.binding,this.open),this.settings.canOpenOnHover&&(this.$body.off("mouseenter",this.settings.binding,this.mouseEnterOpen),this.$body.off("mouseleave",this.settings.binding,this.mouseOutClose))),this.remove()},updateTemplate:function(e){return this.$modal.find(".modal-content").html(e),this.positionDialog(!1),this},open:function(t){var s=this;return t?(t.returnValue=!1,t.preventDefault(),this.$target=e(t.currentTarget)):this.$target=e(this.settings.binding).eq(0),this.$el.fadeIn(this.settings.toggleSpeed,function(){s.broadcast("nyt:modal-show"),s.broadcast("nyt:modal-show-"+s.settings.id)}),this.settings.autoPosition?this.autoPosition():this.positionDialog(!0),(this.settings.openCallback||e.noop).call(this),this.subscribe("nyt:page-resize",this.positionDialog),this.subscribeOnce("nyt:page-key-esc",this.close),this.$body.on("click",this.handleClickClose),this.pageManager.isMobile()&&this.$body.css("cursor","pointer"),this.settings.focusOnShow&&this.$modal.focus(),this},mouseEnterOpen:function(e){window.clearTimeout(this.mouseLeaveTimeout),this.mouseEnterTimeout=t.delay(this.open,this.settings.mouseEnterDelay,e)},close:function(t){var s=this;return t&&t.currentTarget&&this.settings.disableBindings&&e(t.currentTarget).hasClass("modal-pointer")?this:(this.$el.fadeOut(this.settings.toggleSpeed,function(){(s.settings.closeCallback||e.noop).call(s),s.broadcast("nyt:modal-hide"),s.broadcast("nyt:modal-hide-"+s.settings.id)}),this.stopSubscribing("nyt:page-resize",this.positionDialog),this.$body.off("click",this.handleClickClose),window.clearTimeout(this.mouseEnterTimeout),this.pageManager.isMobile()&&this.$body.css("cursor",""),this)},mouseOutClose:function(t){var s=e(t.relatedTarget);s.is(this.$.target)||this.$modal.has(s).length>0||(window.clearTimeout(this.mouseEnterTimeout),this.$modal.is(":visible")&&(this.mouseLeaveTimeout=window.setTimeout(this.close,this.settings.mouseOutDelay)))},handleMouseOutClose:function(){this.settings.closeOnMouseOut&&this.$modal.on("mouseleave",this.close)},handleClickClose:function(e){this.settings.closeOnClick&&0===this.$modal.has(e.target).length&&this.$modal[0]!==e.target&&this.close()},positionDialog:function(t){var s,i,n,a,o,l=this.pageManager.getViewport(),r=this.$target,d=this.$modal,c="absolute",h=d.outerHeight(),u=d.outerWidth(),m={marginLeft:"0",marginTop:"0",top:"",left:""};switch(r&&r.length>0&&(a=r.outerHeight(),o=r.outerWidth(),i=r.offset().top+this.settings.tailTopOffset,n=r.offset().left+this.settings.tailLeftOffset),this.settings.tailDirection){case"up":m.top=i+a+14,m.left=n+Math.floor(.5*o)-Math.floor(.5*u)-9;break;case"up-right":m.top=i+a+14,m.left=n+Math.floor(.5*o)-(u-25);break;case"up-left":m.top=i+a+14,m.left=n+Math.floor(.5*o)-25;break;case"down":m.top=i-h-15,m.left=n+Math.floor(.5*o)-Math.floor(.5*u)-8;break;case"down-right":m.top=i-h-15,m.left=n+Math.floor(.5*o)-(u-25);break;case"down-left":m.top=i-h-15,m.left=n+Math.floor(.5*o)-25;break;case"left":m.top=i+Math.floor(.5*a)-Math.floor(.5*h)+5,m.left=n+o+15;break;case"left-bottom":m.top=i+Math.floor(.5*a)-(h-25),m.left=n+o+15;break;case"left-top":m.top=i+Math.floor(.5*a)-25,m.left=n+o+15;break;case"right":m.top=i+Math.floor(.5*a)-Math.floor(.5*h)+5,m.left=n-u-16;break;case"right-bottom":m.top=i+Math.floor(.5*a)-(h-25),m.left=n-u-16;break;case"right-top":m.top=i+Math.floor(.5*a)-25,m.left=n-u-16;break;case"centered":s=l.height,m.top=h>s?l.top+5:Math.floor(.5*(s-h))+l.top,m.left=Math.floor(.5*l.width-.5*u);break;case"fixed":default:c="fixed",u=this.settings.width||d.width(),h=this.settings.height||d.height(),m.top="50%",m.left="50%",m.marginLeft=-Math.floor(.5*u)+this.settings.tailLeftOffset+"px",m.marginTop=-Math.floor(.5*h)+this.settings.tailTopOffset+"px"}return r&&"fixed"===r.css("position")||this.settings.fixedOverride?(c="fixed",m.top-=l.top,this.$el.css("position","fixed")):this.$el.css("position",""),m.top+=e.isNumeric(m.top)?"px":"",m.left+=e.isNumeric(m.left)?"px":"",d.css("position",c),t===!0?d.css(m):d.stop().animate(m,"fast"),this},autoPosition:function(){var e,t,s,i=this.pageManager.getViewport(),n=this.$modal.outerHeight(),a=this.$modal.outerWidth();return this.settings.positionTailSide&&(s=this.$target.offset().left>i.width/2,this.settings.tailDirection=s?"right":"left"),this.positionDialog(!0),e=this.$target.offset(),this.settings.positionTailSide?(t=this.settings.tailDirection,e.top-i.top-.5*n<0?t+="-top":e.top-i.top+.5*n>i.height&&n-40<e.top-i.top&&(t+="-bottom")):(t=e.top-n<0?"up":"down",e.left+a>i.width?t+="-right":e.left<0&&(t+="-left")),this.$modal.find(".modal-pointer").attr("class","modal-pointer modal-pointer-"+t),this.settings.tailDirection=t,this.positionDialog(!0),this}});return n}),define("shared/ad/views/ads",["underscore/nyt","jquery/nyt","foundation/views/base-view","foundation/views/ad-view-manager","shared/ad/collections/ads","shared/ad/templates","shared/modal/views/modal"],function(e,t,s,i,n,a,o){var l=s.registerView("ads").extend({el:".ad",template:a,pushdownWidth:"970",billboardHeight:"90",navBreakPoint:10040,positions:null,blocking:!1,adShown:{},initialize:function(t){e.bindAll(this,"completeInterstitial","renderAd"),this.options=t||this.options||{},this.positions=[],this.preInitialize(),this.local(this,"nyt:ads-pre-initialize"),this.detectTragedy(),this.setAdParametersOnOptions(),this.scope=this.options.scope||this.scope,this.confirm=!0,this.ads=new n([],this.options),this.subscribe(this.ads,"sync",this.receiveAds),this.secondaryIframeClass="frame-for-"+this.scope,this.listenTo(this.pageManager,"nyt:page-breakpoint",this.responsive),this.postInitialize(),this.local(this,"nyt:ads-post-initialize"),this.subscribe("nyt:ads-new-placement",this.handleRemoteAdRequest),this.subscribe("nyt:ads-fire-ribbon-interstitial",this.fireRibbonInterstitial),this.subscribe("nyt:slideshow-ad",this.fireSlideShowAd),this.addAmazonKeywords?this.getAmazonAds():this.requestAds()},getAmazonAds:function(){window.amznads={updateAds:function(t){window.amazonAdData=t.ads,window.amazonAdSlots=e.keys(window.amazonAdData)},renderAd:function(e,t){var s,i;window.amazonAdData&&window.amazonAdData[t]?(e.write(window.amazonAdData[t]),e.close()):(s={c:"dtb",src:"3030",kvmismatch:1,pubReturnedKey:t,aaxReturnedKeys:window.amazonAdSlots,cb:Math.round(1e7*Math.random()),u:window.encodeURIComponent(window.location.host+window.location.pathname),ua:encodeURIComponent(window.navigator.userAgent)},i=window.encodeURIComponent(JSON.stringify(s)),e.write('<img src="//aax.amazon-adsystem.com/x/px/p/0/'+i+'"/>'),e.close())}},this.getAmazonKeywordsAndRequestAds()},getAmazonKeywordsAndRequestAds:function(){var e=this,s="3030",i=encodeURIComponent(document.location);try{i=encodeURIComponent(""+window.top.location)}catch(n){}t.ajax({url:"//aax.amazon-adsystem.com/e/dtb/bid?src="+s+"&u="+i+"&cb="+Math.round(1e7*Math.random()),dataType:"script"}).done(function(){e.addAmazonKeywords()}).always(function(){e.requestAds()})},preInitialize:t.noop,postInitialize:t.noop,responsive:t.noop,setHtmlClasses:t.noop,requestAds:function(){this.options.response?(this.ads.reset(this.ads.parse(this.options.response)),this.ads.trigger("sync")):this.ads.fetch()},receiveAds:function(){this.hasInterstitial()||this.checkAds()},resizeTopAd:e.debounce(function(){var e=this.ads.findWhere({name:"TopAd"});if(e){var s=e.get("height");s&&90>s&&t("#TopAd").css("min-height",parseInt(s,10))}},1e3),checkAds:function(){var s,i,n,a,o,l=this;for(this.removeAds(),s=this.getReturnedAdNames(this.pageManager.isDomReady()),this.pageManager.isDomReady()||this.subscribe("nyt:page-ready",function(){l.getReturnedAdNames(!0)}),s&&s.length>0&&(this.pageManager.getMeta("ads_adNames")||this.pageManager.setMeta("ads_adNames",this.returnAdNames())),e.indexOf(s,"TopAd")<0?(o=t("#TopAd"),0===o.length&&o.addClass("hidden")):l.resizeTopAd(),a=this.getPositions(),i=0,n=a.length;n>i;i+=1)t("#"+a[i]).toggleClass("hidden",l.isAdUnavailable(s,a[i]));e.indexOf(this.options.positions,"Middle1C")>=0&&!this.ads.findWhere({name:"Middle1C"})&&t("#TopNavAd, .search-flyout-panel .ad").addClass("hidden"),e.defer(function(){l.broadcast("nyt:ads-rendered",l)}),l.setHtmlClasses(),e.delay(function(){l.loadGoogleAdScript()},1200)},loadGoogleAdScript:function(){if(0!==t("#SponLink, #SponLinkA, #HPSponLink").length&&!this.pageManager.getMeta("googleAdScriptInjected")){var e="script",s=document.createElement(e),i=document.getElementsByTagName(e)[0];s.src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",i.parentNode.insertBefore(s,i),this.pageManager.setMeta("googleAdScriptInjected","true")}},renderAd:function(e){e.page=e.page||this.ads.options.page,e.frameStyle=e.frameStyle||this.template.iFrameStyleSheet(),e.secondaryIframeClass=e.secondaryIframeClass||this.secondaryIframeClass,i.render(e)},renderAdByPositionName:function(s,i){var n=t("#"+s);return i||(i=this.ads.where({name:s})[0]),n.length&&i||"ADX_CLIENTSIDE"===s?(this.isCreativeBlank(i)||n.removeClass("hidden"),e.defer(this.renderAd,{model:i,el:n}),!0):!1},handleRemoteAdRequest:function(e){this.ads.length>0&&this.renderAdByPositionName(e)},getPositions:function(){return this.options.positions},detectTragedy:function(){var e=this.pageManager.getMeta("ad_sensitivity");e&&(this.options.page="www.nytimes.com/"+e)},returnAdNames:function(){return this.ads.pluck("name")},cleanHtmlClasses:function(){this.htmlClasses&&this.$html.removeClass(e.values(this.htmlClasses).join(" "))},isDirectlySold:function(e){var t=this.ads.where({name:e})[0].attributes.isDirectlySold;return"true"===t},returnAdParametersObject:function(){var t=this.pageManager.getUrlParam("ad-keywords"),s=this.pageManager.getUrlParam("ad-positions");return{keywords:e.isString(t)?[t]:t,positions:e.isString(s)?[s]:s}},setAdParametersOnOptions:function(){var t=this.returnAdParametersObject();this.options.keywords=e.union(this.options.keywords,t.keywords),t.positions&&(this.options.positions=t.positions)},isPlaceholderInViewport:function(e){var s;return!e||e&&0===e.length?!1:(s=e.get(0).getBoundingClientRect(),s.top+e.height()>=0&&s.left+e.width()>=0&&s.bottom-e.height()<=t(window).height()&&s.right-e.width()<=t(window).width())},isCreativeBlank:function(e){var t=e.get("classification");return"blank"===t||"blank-but-count-imps"===t},handleApplicationAd:function(e){var t,s;return t=e.get("name"),s=this.renderAdByPositionName(t,e)},getReturnedAdNames:function(e){var t=this,s=[];return e="undefined"!=typeof e?e:!1,this.ads.length>0&&this.ads.each(function(i){e?t.handleApplicationAd(i)?s.push(i.get("name")):t.confirm=!1:s.push(i.get("name"))}),s},isAdUnavailable:function(t,s){return e.indexOf(t,s)<0||this.isCreativeBlank(this.ads.where({name:s})[0])},removeAds:function(){t("."+this.secondaryIframeClass).remove()},isHalfPage:function(e,t){return 300===parseInt(e,10)&&600===parseInt(t,10)},isPushdown:function(e,t){return e===this.pushdownWidth&&t!==this.billboardHeight},handleTopNav:function(s){var i,n,a,o,l=t("#SponsorAd"),r=l.find("iframe"),d=t("#TopNavAd"),c=d.find("iframe");return i=this.ads.findWhere({name:"Middle1C"}),a=s<this.navBreakPoint&&0===r.length,o=s>=this.navBreakPoint&&0===c.length,i&&(a||o)?(a?(n=l,c.remove()):(n=d,r.remove()),e.defer(this.renderAd,{el:n,model:i}),!0):!1},fireSlideShowAd:function(e){var s=this.ads.findWhere({name:e.position}),i=t('<div class="ad-wrapper"></div>');this.adShown[e.position]||"object"!=typeof s||(this.adShown[e.position]=!0,e.el.html(i),this.renderAd({el:i,model:s}),this.broadcast("nyt:slideshow-ad-render",s))},hasInterstitial:function(){var e,t=this.ads.findWhere({name:"Interstitial"});return t?(e=t.get("timeout")?1e3*parseInt(t.get("timeout"),10):15e3,this.createInterstitial(t,this.completeInterstitial,e),!0):!1},fireRibbonInterstitial:function(){var e=this.pageManager.getViewport();this.$shell.prepend(a.ribbonInterstitial()),this.renderAdByPositionName("RibbonInterstitial"),this.$shell.find("#main").addClass("visually-hidden").end().find(".ribbon-interstitial-ad-overlay").css("height",e.height-150).find("iframe").css("width","")},createInterstitial:function(e,t,s){var i=this;this.interstitialModal=new o({id:"interstitial-ad-modal",modalTitle:"advertisement",tailDirection:"fixed",hasOverlay:!0,hasCloseButton:!0,width:e.get("width"),height:e.get("height"),modalContent:a.interstitialModal(),closeCallback:t,openCallback:function(){i.renderAdByPositionName(e.get("name"))}}).addToPage().open(),s&&(i.closeTimeout=window.setTimeout(this.interstitialModal.close,s))},completeInterstitial:function(e){window.clearTimeout(this.closeTimeout),this.interstitialModal.removeFromPage(),this.ads.remove(e),this.checkAds()}});return l}),define("topic/templates",["underscore/nyt"],function(_){var templates={};return templates.google300x250Text=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>\n<ins class="adsbygoogle"\nstyle="display:inline-block;width:300px;height:250px"\ndata-ad-client="nytimes_article_var"\ndata-color-bg="#ffffff"\ndata-font-face="times"\ndata-font-size="small"\ndata-color-border = \'e5e5e5\'\ndata-color-line = \'ffffff\'\ndata-color-link = \'3886ab\'\ndata-color-url = \'3886ab\'\ndata-color-text = \'666666\'\ndata-safe = \'high\'\n></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>';return __p},templates.google395x90Text=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+="<div style=\"text-align: center; font-family: Arial; font-size: 10px; color:#ccc; margin-bottom: 6px;\">Advertising</div>\n<ins class=\"adsbygoogle\"\nstyle=\"display:inline-block;width:395px;height:90px\"\ndata-ad-client=\"nytimes_article_var\"\ndata-color-bg=\"#f8f8f9\"\ndata-font-face=\"arial\"\ndata-font-size=\"small\"\ndata-color-border = '#e5e5e5'\ndata-color-line = '#fff'\ndata-color-link = '#9f9697'\ndata-color-url = '#9f9697'\ndata-color-text = '#bfbcc3'\ndata-ad-type = 'text'\ndata-safe = 'high'\ndata-max-num-ads = '1'\n></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>";return __p},templates.google728x90Text=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>\n<ins class="adsbygoogle"\nstyle="display:inline-block;width:728px;height:90px"\ndata-ad-client="nytimes_article_var"\ndata-color-bg="#ffffff"\ndata-font-face="times"\ndata-font-size="small"\ndata-color-border = \'e5e5e5\'\ndata-color-line = \'ffffff\'\ndata-color-link = \'3886ab\'\ndata-color-url = \'3886ab\'\ndata-color-text = \'666666\'\ndata-safe = \'high\'></ins>\n<script>\n(adsbygoogle = window.adsbygoogle || []).push({});\n</script>';return __p},templates.mostPopular=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",collection.length&&(__p+="\n<ol>\n",_.each(collection.slice(0,10),function(e){__p+='\n<li>\n<a class="story-link" href="'+(null==(__t=e.get("link"))?"":__t)+'">\n<article class="story theme-summary">',e.getCrop("thumbStandard")&&(__p+='\n<div class="thumb">\n<img src="'+(null==(__t=e.getCrop("thumbStandard").url)?"":__t)+'" />\n</div>\n'),__p+='<div class="story-heading">\n<h6 class="story-kicker truncate-text">\n',e.get("kicker")&&(__p+="\n"+(null==(__t=e.get("kicker"))?"":__t)+"\n"),__p+='\n</h6>\n<h4 class="story-text truncate-text">\n'+(null==(__t=e.get("headline"))?"":__t)+"\n</h4>\n</div></article>\n</a>\n</li>\n"}),__p+="\n</ol>"),__p+="";return __p},templates.welcomeBack=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="story-group"></div><div id="WelcomeBack" class="ad welcome-back-ad"></div><div class="modal-footer">\n<button class="button dismiss-button">Back to Article</button>\n</div>';return __p},templates.welcomeBackStories=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",collection.length&&(__p+="<ul>",_.each(collection.slice(0,3),function(e){__p+='<li>\n<a class="story-link" href="'+(null==(__t=e.get("link"))?"":__t)+'">\n<article class="story theme-summary">',e.getCrop("thumbStandard")&&(__p+='\n<div class="thumb">\n<img src="'+(null==(__t=e.getCrop("thumbStandard").url)?"":__t)+'" />\n</div>\n'),__p+='<h2 class="story-heading">\n<span class="story-heading-text">',e.get("kicker")&&(__p+="\n"+(null==(__t=e.get("kicker"))?"":__t)+":\n"),__p+="\n"+(null==(__t=e.get("headline"))?"":__t)+'</span>\n<time class="dateline" datetime="'+(null==(__t=e.getDatetime())?"":__t)+'">'+(null==(__t=e.getFormattedDate())?"":__t)+"</time>\n</h2></article>\n</a>\n</li>"}),__p+='</ul><p class="user-action">\n<a href="/recommendations">More Recommended Articles &raquo;</a>\n</p>'),__p+="";return __p},templates.welcomeBackTitle=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<i class="icon"></i>\n<span class="heading-text">Recommended Articles</span>';return __p},templates}),define("topic/views/ads/ads",["jquery/nyt","underscore/nyt","shared/ad/views/ads","topic/templates"],function(e,t,s,i){var n=s.extend({bigAdTopTarget:775,halfPageTopTarget:600,adFold:900,verticalImagePixelMargin:15,portraitSize:1020,scope:"topic",bigAdCounter:1,htmlClasses:{XXL:"has-xxl",HalfPage:"has-half-page",BigAd:"has-big-ad",TopAd:"has-top-ad"},templates:i,options:{adx_campaign:"www.nytimes.com",response:window.NYTADX?window.NYTADX.response:null,positions:window.NYTADX?window.NYTADX.positions:[],keywords:[]},preInitialize:function(){this.cleanArguments(),this.addTopicKeywords()},cleanArguments:function(){this.pageManager.getCurrentBreakpoint()<=this.portraitSize&&(this.options.positions=t.reject(this.options.positions,function(e){return"XXL"===e}))},postInitialize:function(){this.adPlacements=e("#story").find(".ad-placeholder"),this.adPlacements.length>0&&this.subscribe("nyt:page-scroll",this.checkBigAdPlacements)},handleAdsForSmallViewport:function(s){var i=e("#XXL"),n=e("#TopAd"),a=n.find("iframe");-1!==t.indexOf(this.options.positions,"XXL")&&i.find("iframe").length>0&&(s<=this.portraitSize?(i.addClass("hidden"),this.$html.removeClass(this.htmlClasses.XXL)):(i.removeClass("hidden"),this.$html.addClass(this.htmlClasses.XXL))),-1!==t.indexOf(this.options.positions,"TopAd")&&a.length>0&&a.height()>1&&n.toggleClass("hidden",a.width()>728&&1030>=s)},handleApplicationAd:function(e){var t,s=e.get("name");return"Middle1C"===s?t=this.handleTopNav(this.pageManager.getCurrentBreakpoint()):"MiddleRight"===s?t=this.handleMiddleRightAd(e):("XXL"===s&&this.$html.addClass(this.htmlClasses.XXL),"TopAd"===s&&"blank"!==e.get("classification")&&this.$html.addClass(this.htmlClasses.TopAd),t=this.renderAdByPositionName(s,e)),t},checkBigAdPlacements:function(){var t,s,i=this,n=this.adPlacements.length-1;this.adPlacements.each(function(a,o){i.isPlaceholderInViewport(e(o))&&(a===n?(s="Box1",i.stopSubscribing("nyt:page-scroll",this.checkBigAdPlacements)):s="MiddleRight"+i.bigAdCounter,t=i.ads.findWhere({name:s}),t&&(i.renderAd({el:e(o),model:t}),i.adPlacements.splice(a,1),i.bigAdCounter+=1,i.trackingComscorePVC({module:"Ad",version:t.get("name"),action:"Impression",contentCollection:t.get("campaign"),contentID:t.get("classification"),region:i.ads.options.page,eventName:"AdImpression"})))})},handleMiddleRightAd:function(e){var t=this;return this.$html.toggleClass(function(){return"blank"===e.get("classification")?"":(t.cleanHtmlClasses(),t.isHalfPage(e.get("width"),e.get("height"))?t.htmlClasses.HalfPage:t.htmlClasses.BigAd)}),t.renderAdByPositionName("MiddleRight"),!0},setHtmlClasses:function(){var t=this;this.$html.toggleClass(function(){return 1===e("#XXL").find("iframe").length?(t.cleanHtmlClasses(),t.htmlClasses.XXL):""})},responsive:function(e){this.handleAdsForSmallViewport(e),this.handleTopNav(e)},addTopicKeywords:function(){var e=this.pageManager.getMeta("article:tag");this.options.keywords=t.union(this.options.keywords,e)}});return n}),define("topic/instances/ad-manager",["foundation/views/page-manager","topic/views/ads/ads"],function(e,t){if(!e.getMeta("errorpage")){new t}}),define("shared/sharetools/templates",["underscore/nyt"],function(_){var templates={};return templates.emailModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<iframe src="'+(null==(__t=emailThisUrl)?"":__t)+(null==(__t=dataUrl)?"":__t)+'" title="Email This" id="emailthis" scrolling="'+(null==(__t=scrolling)?"":__t)+'" marginheight="0" marginwidth="0" frameborder="0"></iframe>';return __p},templates.savemodal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="instructions">\n<li>This item has been saved to read later from any device. </li>\n<li>Access saved items through your user name at the top of the page.</li>\n</ul>\n<p><a href="'+(null==(__t=link)?"":__t)+'">View Saved Items</a><p>\n<button class="button dismiss-button">OK</button>';return __p},templates.shareTool=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a href="javascript:;" data-share="'+(null==(__t=id)?"":__t)+'"><i class="icon"></i><span class="sharetool-text '+(null==(__t=isLabelHidden===!0?"visually-hidden":"")?"":__t)+'">'+(null==(__t=label)?"":__t)+"</span></a>";return __p},templates.shareTools=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="<ul>\n",_.each(shares,function(e){__p+='\n<li class="sharetool '+(null==(__t=e.type)?"":__t)+"-sharetool "+(null==(__t=config[e.type].loginRequired?"login-modal-trigger":"")?"":__t)+'" data-modal-title="'+(null==(__t=config[e.type].loginModalText||"")?"":__t)+'">\n<a href="javascript:;" data-share="'+(null==(__t=e.type)?"":__t)+'"><i class="icon"></i><span class="sharetool-text">'+(null==(__t=e.label)?"":__t)+"</span></a>\n</li>\n"}),__p+="\n</ul>";return __p},templates.shareToolsModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="section share">\n<ul class="sharetools-menu">\n'+(null==(__t=standardToolsList)?"":__t)+'\n</ul>\n<form class="short-url-form">\n<div class="control">\n<div class="label-container"><label for="short-url-input">Permalink</label></div>\n<div class="field-container">\n<input id="short-url-input" class="short-url-input text" type="text" name="short-url-input" value="'+(null==(__t=shortUrl)?"":__t)+'" readonly="readonly" />\n</div>\n</div>\n</form>\n</div><!--close section -->\n<div class="section tools">\n<h4 class="modal-heading">Tools</h4>\n<ul class="sharetools-menu">\n'+(null==(__t=articleToolsList)?"":__t)+'\n</ul>\n</div><!--close section -->\n<div class="modal-footer">\n<div class="ad show-all-sharetool-modal-ad hidden">\n<small class="ad-sponsor">Article Tools Sponsored By</small>\n</div>\n</div><!-- close modal footer -->';return __p},templates.showAllSharetoolCompactModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="section share">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllLinkList)?"":__t)+'\n</ul>\n</div> <!--close section -->\n<div class="section tools">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllToolList)?"":__t)+'\n</ul>\n<div class="control permalink-control">\n<div class="label-container">\n<label for="permalink-input" class="sharetools-label">Permalink</label>\n</div>\n<div class="field-container">\n<input id="permalink-input" type="text" class="text short-url-input" placeholder="" readonly />\n<span class="textbox-fade"></span>\n</div>\n</div><!-- close control -->\n<div class="control embed-control">\n<div class="label-container">\n<label for="embed-input" class="sharetools-label">Embed</label>\n</div>\n<div class="field-container">\n<input id="embed-input" type="text" class="text embed-input" placeholder="" readonly />\n<span class="textbox-fade"></span>\n</div>\n</div><!-- close control -->\n</div> <!--close section -->\n<div class="modal-footer">\n<div class="ad show-all-sharetool-modal-ad hidden">\n<small class="ad-sponsor">Share Tools Sponsored By</small>\n</div>\n</div> <!-- close modal footer -->';return __p},templates.showAllSharetoolModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="section share">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllLinkList)?"":__t)+'\n</ul>\n<form class="short-url-form">\n<div class="control">\n<div class="label-container"><label for="short-url-input">Permalink</label></div>\n<div class="field-container">\n<input id="short-url-input" class="short-url-input text" type="text" name="short-url-input" value="'+(null==(__t=shortUrl)?"":__t)+'" readonly/>\n</div>\n</div>\n</form>\n</div> <!--close section -->\n<div class="section tools">\n<h5 class="modal-heading"> Tools </h5>\n<ul class="sharetools-menu">\n'+(null==(__t=showAllToolList)?"":__t)+'\n</ul>\n</div> <!--close section -->\n<div  class="modal-footer">\n<div class="ad show-all-sharetool-modal-ad hidden">\n<small class="ad-sponsor">Article Tools Sponsored By</small>\n</div>\n</div> <!-- close modal footer -->';return __p},templates.showallLinks=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<li class="sharetool '+(null==(__t=shareObj.type)?"":__t)+"-sharetool "+(null==(__t=config.loginRequired?"login-modal-trigger":"")?"":__t)+'" data-modal-title="'+(null==(__t=config.loginModalText||"")?"":__t)+'">\n<a href="javascript:;" data-share="'+(null==(__t=shareObj.type)?"":__t)+'"><i class="icon"></i>'+(null==(__t=shareObj.label)?"":__t)+"</a>\n</li>";return __p},templates}),define("shared/sharetools/views/email",["jquery/nyt","underscore/nyt","foundation/hosts","foundation/views/base-view","shared/modal/views/modal","shared/sharetools/templates"],function(e,t,s,i,n,a){var o=i.extend({template:a.emailModal,className:"email-view-container",frameSize:{small:507,full:867,ad:285},defaultSettings:{emailThisUrl:"https:"+s.www+"/mem/email-this.html?url=",scrolling:window.Modernizr.postmessage?"no":"yes"},defaultModalSettings:{id:"email-share-modal",modalTitle:"Email This Article",binding:".email-sharetool",tailDirection:"centered",hasOverlay:!0,hasCloseButton:!0,modalContent:""},initialize:function(e){var s=this;
t.bindAll(this,"handlePostMessage","responsive"),this.settings=t.extend({},this.defaultSettings,e),this.frameState="full",this.modalSettings=t.extend({},this.defaultModalSettings,{openCallback:function(){window.Modernizr.postmessage&&(window.addEventListener?window.addEventListener("message",s.handlePostMessage,!1):window.attachEvent("onmessage",s.handlePostMessage)),s.listenTo(s.pageManager,"nyt:page-breakpoint",s.responsive)},closeCallback:function(){this.removeFromPage(),window.addEventListener?window.removeEventListener("message",s.handlePostMessage,!1):window.detachEvent("onmessage",s.handlePostMessage),s.stopListening(s.pageManager,"nyt:page-breakpoint",s.responsive)}}),this.render()},render:function(){this.modalSettings.modalContent=this.template(this.settings),this.emailModal=new n(this.modalSettings),this.emailModal.addToPage(),t.defer(this.responsive,this.pageManager.getCurrentBreakpoint())},responsive:function(e){var t=this.emailModal.$modal.find("iframe");1010>=e&&"full"===this.frameState&&(t.css("height",t.height()+this.frameSize.ad+"px").width(this.frameSize.small),this.frameSize.state="small",this.emailModal.positionDialog()),e>1010&&"small"===this.frameState&&(t.css("height",t.height()-this.frameSize.ad+"px").width(this.frameSize.full),this.frameState="full",this.emailModal.positionDialog())},handlePostMessage:function(e){var t;/\.nytimes\.com$/.test(e.origin)&&(t=e.data.match(/(.+)\:(.+)/),t&&"frameheight"===t[1]?this.$el.css("height",t[2]):t&&"closewindow"===t[1]?this.emailModal.close():t&&"loginredirect"===t[1]&&(window.location=s.myaccount+"/auth/login?URI="+encodeURIComponent(window.location.href)))}});return o}),define("shared/sharetools/helpers/sharetools-config",["jquery/nyt","foundation/hosts"],function(){var e={};return e.common={mainClassName:"shareTools",itemClassName:"shareToolsItem",defaultActiveShares:"email,facebook,twitter,save,show-all|more,ad",defaultShowAllShares:"facebook|Share,email|Email,twitter|Tweet,linkedin|LinkedIn,google|Google+,reddit|Reddit,save|Save,reprints|Reprints,print|Print,ad",defaultUrl:window.location.href.replace(/#.*/,""),defaultTitle:document.title,defaultDescription:"",defaultAdPosition:"Frame4A",defaultOverlayAdPosition:"Frame6A",defaultWidth:600,defaultHeight:450,defaultTransition:"fade",labelSpecialChar:"|",hasAd:!1,loadedAdPositions:[],shortUrlApi:"http://www.nytimes.com/svc/bitly/shorten.jsonp",emailThisUrl:"https://www.nytimes.com/mem/email-this.html?url=",count:0},e.tools={facebook:{active:!0,onShowAll:!0,label:"Facebook",postUrl:"http://www.facebook.com/sharer.php",postType:"popup",shareParameters:{url:"u"},smid:"fb-share",width:655,height:430},twitter:{active:!0,onShowAll:!0,label:"Twitter",postUrl:"https://twitter.com/share",postType:"popup",shareParameters:{url:"url",title:"text",via:"via"},smid:"tw-share",width:600,height:450},google:{active:!0,onShowAll:!0,label:"Google+",postUrl:"https://plus.google.com/share",postType:"popup",shareParameters:{url:"url"},urlParameters:{hl:"en-US"},smid:"go-share",width:600,height:600},tumblr:{active:!0,onShowAll:!0,label:"Tumblr",postUrl:"http://www.tumblr.com/share/link",postType:"popup",shareParameters:{url:"url",title:"name",description:"description"},smid:"tu-share",width:560},linkedin:{active:!0,onShowAll:!0,label:"Linkedin",postUrl:"http://www.linkedin.com/shareArticle",postType:"popup",shareParameters:{url:"url",title:"title",description:"summary"},urlParameters:{mini:"true",source:"The New York Times"},smid:"li-share",width:750,height:450},reddit:{active:!0,onShowAll:!0,label:"Reddit",postUrl:"http://www.reddit.com/submit",postType:"popup",shareParameters:{url:"url",title:"title"},smid:"re-share",width:854,height:550},email:{loginModalText:"Log in to Email",active:!0,onShowAll:!0,label:"Email",loginRequired:!0},permalink:{active:!0,onShowAll:!0,label:"Permalink",postUrl:"http://www.nytimes.com/export_html/common/new_article_post.html",postType:"popup",shareParameters:{url:"url",title:"title",description:"summary"},smid:"pl-share",width:460,height:380,loginRequired:!1},"show-all":{active:!0,onShowAll:!1,label:"Show All"},reprints:{active:!0,onShowAll:!1,label:"Reprints",postUrl:"https://s100.copyright.com/AppDispatchServlet",postType:"popup",shareParameters:{url:"contentID"},urlParameters:{publisherName:"The New York Times",publication:"nytimes.com",token:"",orderBeanReset:"true",postType:"",wordCount:"",title:document.title,publicationDate:"",author:""}},save:{loginModalText:"Log in to Save",active:!0,onShowAll:!1,label:"Save",postUrl:e.common.defaultUrl.replace(/\?.*/,""),loginRequired:!0},print:{active:!0,onShowAll:!1,label:"Print",postUrl:e.common.defaultUrl,postType:"link",urlParameters:{pagewanted:"print"}},ad:{active:!0,onShowAll:!1,label:"Advertisement"},embed:{active:!0,onShowAll:!0,label:"Embed",loginRequired:!1},pinterest:{active:!0,onShowAll:!0,label:"Pinterest",postUrl:"https://www.pinterest.com/pin/create/button/",postType:"popup",shareParameters:{url:"url",media:"media",description:"description"},smid:"pin-share",width:600,height:450,loginRequired:!1}},e}),define("shared/sharetools/collections/cross-platform-save",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/collections/base-collection","foundation/hosts","foundation/lib/auth/userauth"],function(e,t,s,i,n,a){var o=i.extend({COMMAND:{save:"add",check:"list"},url:n.du+"/svc/profile/reading-list/v1/",save:function(e){var t=this;this.sync(this.COMMAND.save,e).done(function(s){t.add(s),t.trigger("nyt:xps-saved",e,s)}).fail(function(){t.trigger("nyt:xps-failed",e)})},sync:function(t,s){var i=new e.Deferred,n=setTimeout(function(){i.reject()},5e3),o={url:s},l={type:"GET",jsonp:"callback",jsonpCallback:"xpsCallback",dataType:"jsonp",cache:!0,url:this.url+t+".jsonp",data:"",success:function(e){clearTimeout(n),e&&e.assets?i.resolve(e.assets):i.reject()}};return a.getToken().done(function(t,s,i){t&&s&&"undefined"!=typeof i&&(l.data+="&token="+t),l.data+="&data="+JSON.stringify(o),e.ajax(l)}),i.promise()}});return o}),define("shared/sharetools/instances/cross-platform-save",["shared/sharetools/collections/cross-platform-save"],function(e){return new e}),define("shared/data/models/article",["underscore/nyt","backbone/nyt"],function(e,t){var s=t.Model.extend({defaults:{title:"",kicker:"",pubdate:"",link:"",media:[{caption:"","media-metadata":[{url:""}]}],promotional_media:[{image:{image_crops:{}}}],processed:!1},initialize:function(){this.adjustKicker()},adjustKicker:function(){this.isOpinion()&&this.get("authors")&&this.set("kicker",this.get("authors")[0])},isOpinion:function(){return"Op-Ed Columnist"===this.get("kicker")||"Opinionator"===this.get("kicker")},getCrop:function(e){var t=this.get("promotional_media"),s="",i="image";try{if(t.type&&"image"!==t.type){switch(i=t.type){case"video":s="Play Video";break;case"slideshow":s="View Slideshow";break;case"interactive":s="View Interactive";break;default:s="View Media"}t=t.promotional_media}return t.image.image_crops[e].type=i,t.image.image_crops[e].typeName=s,t.image.image_crops[e]}catch(n){return}},createDateObject:function(e){var t,s,i=new Date(e);return i.getDate()||e.search(/\d+T\d+/)>=0&&(t=e.split("T")[0],s=t.split("-"),i=new Date(s[0],s[1]-1,s[2])),i},getFormattedDate:function(e){var t,s=["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."];return e=e||this.get("pubDate"),t=this.createDateObject(e),s[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()},getDatetime:function(e){var t;return e=e||this.get("pubDate"),t=this.createDateObject(e),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}});return s}),define("shared/sharetools/collections/short-url",["jquery/nyt","backbone/nyt","foundation/collections/base-collection","shared/data/models/article","foundation/hosts","underscore/nyt"],function(e,t,s){var i=s.extend({url:"http://www.nytimes.com/svc/bitly/shorten.jsonp",initialize:function(){this.currentUrlRequest="",this.addCurrentPage()},sync:function(e,s,i){return i.dataType="jsonp",i.jsonpCallback="shortUrlCallback",i.jsonp="callback",i.cache=!0,i.data={url:this.currentUrlRequest},t.sync(e,s,i)},parse:function(e){return{url:this.currentUrlRequest,shortUrl:e.payload?e.payload.short_url:""}},addCurrentPage:function(){var t,s=this.pageManager.getCanonical();t="1"===this.pageManager.getUrlParam("rico")&&"undefined"!=typeof this.pageManager.getUrlParam("share_url")?this.pageManager.getUrlParam("share_url"):e("#masthead").find(".story-short-url").text(),s&&t&&this.add({url:s,shortUrl:t})},getRicoUrl:function(e){var t=this.pageManager.getUrlParam("share_url"),s=document.createElement("a");return s.href=e,s.pathname===location.pathname&&t&&7===t.indexOf("r-i.co/")?t:void 0},requestUrl:function(e){var t,s=this.findWhere({url:e});return s?s.get("shortUrl"):(t=this.getRicoUrl(e))?t:(this.currentUrlRequest=e,this.fetch(),void 0)}});return i}),define("shared/sharetools/instances/short-url",["shared/sharetools/collections/short-url"],function(e){return new e}),define("shared/sharetools/helpers/sharetools-mixin",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/sharetools/templates","shared/ad/views/ads","shared/sharetools/views/email","shared/modal/views/modal","shared/sharetools/instances/cross-platform-save","foundation/models/page-storage","foundation/hosts","foundation/models/user-data","shared/sharetools/helpers/sharetools-config","shared/sharetools/instances/short-url"],function(e,t,s,i,n,a,o,l,r,d,c,h,u){var m={getDataAttrs:function(e,s){var i,n=s||this.$el.data(),a=(n.shares||h.common[e?"defaultShowAllShares":"defaultActiveShares"]).split(","),o=[],l=h.common.hasAd;e&&(h.common.defaultUrl.indexOf("aponline")>-1||h.common.defaultUrl.indexOf("reuters")>-1)&&(a=t.without(a,"reprints|Reprints"));for(var r=0,d=a.length;d>r;r+=1)a[r].indexOf("|")>0?(i=a[r].split("|"),o.push({type:i[0],label:i[1]})):"ad"===a[r]?l=!0:o.push({type:a[r],label:a[r]});return h.tools.reprints.urlParameters.publicationDate=n.publishDate,t.extend({},{inlineTools:o,ad:l,url:h.common.defaultUrl,title:h.common.defaultTitle,description:h.common.defaultDescription},n)},setUpConfigOptions:function(){h.common.defaultTitle=this.pageManager.getMeta("og:title")||document.title,h.common.defaultDescription=this.pageManager.getMeta("description")||""},isMobileSharetools:function(){return this.pageManager.getCurrentBreakpoint()<1e3},openMailToLink:function(){var e="%0A%0A",t=encodeURIComponent(this.settings.title),s=encodeURIComponent(this.settings.description),i=encodeURIComponent(this.settings.url),n="NYTimes.com: "+t,a="From The New York Times:"+e+t+e+s+e+i;window.location="mailto:?subject="+n+"&body="+a},handleShortUrlShareAction:function(t,s){var i,n=this,a=window.open("",t.label+"Share","toolbar=0,status=0,height="+t.height+",width="+t.width+",scrollbars=yes,resizable=yes"),o=s||this.settings.url,l=this.createAnchor(o);/(?:iPad|iPhone); CPU OS [0-7]/.test(navigator.userAgent)||t.smid&&(l.search+=0===l.search.indexOf("?")?"&":"?",l.search+="smid="+t.smid,o=l.href),i=u.requestUrl(o)||"",i?this.shortUrlRedirect(i,t,a):this.listenToOnce(u,"add",function(){var e=u.findWhere({url:o});e&&n.shortUrlRedirect(e.get("shortUrl"),t,a)}),navigator.userAgent.match(/iPad/i)&&navigator.userAgent.match(/Safari/i)&&this.shortUrlRedirect(e("#masthead").find(".story-short-url").text(),t,a)},shortUrlRedirect:function(s,i,n){var a,o,l=[],r=t.extend({},this.settings);if(i.shareParameters&&r){var d=this.getTrackingParam();d&&(i.shareParameters.smv=d,r.smv=null),e.each(i.shareParameters,function(e,t){a="url"===e?s:r[e],a?l.push(t+"="+encodeURIComponent(a)):null===a&&l.push(t)})}l=l.join("&"),o=i.postUrl+this.paramChar(i.postUrl)+l,this.shoveUrlToNewWindow(o,n)},shoveUrlToNewWindow:function(e,t){t.document.location=e,t.document.close()},itemSaved:function(){r.get("sharetools_hasSaves")!==!0?(this.firstTimeSaveModal(),r.set("sharetools_hasSaves",!0)):this.growlSaveModal()},growlSaveModal:function(){var e=new o({id:"save-item-growl-modal",modalTitle:'<i class="icon"></i>Saved',tailDirection:"centered",openCallback:function(){window.setTimeout(this.removeFromPage,2e3)}}).addToPage();t.defer(e.open)},firstTimeSaveModal:function(){var e=new o({id:"save-item-modal",modalTitle:'<i class="icon"></i>Saved',modalContent:i.savemodal({link:d.www+"/saved"}),hasOverlay:!0,hasCloseButton:!0,tailDirection:"centered",closeCallback:function(){this.removeFromPage()}}).addToPage();t.defer(e.open)},saveAction:function(){var e=l.where({url:this.settings.url});return c.isLoggedIn()?(0===e.length?(this.subscribeOnce(l,"nyt:xps-saved",this.itemSaved),l.save(this.settings.url)):this.growlSaveModal(),void 0):!0},paramChar:function(e){return-1!==e.indexOf("?")?"&":"?"},buildUrl:function(s,i){var n,a,o=h.tools[s],l=[],r=o.postUrl,d=t.extend({},i||this.settings),c=this.getTrackingParam();if(c&&(o.urlParameters=o.urlParameters||{},o.urlParameters[c]=null),n=u.getRicoUrl(d.url),n&&"email"!==s&&(d.url=n),a=this.createAnchor(d.url),o.smid&&(a.search+=0===a.search.indexOf("?")?"&":"?",a.search+="smid="+o.smid,d.url=a.href),o.shareParameters&&d){var m;e.each(o.shareParameters,function(e,t){m=d[e],l.push(t+"="+encodeURIComponent(m))})}return o.urlParameters&&e.each(o.urlParameters,function(e,t){null!==t?l.push(e+"="+encodeURIComponent(t)):l.push(e)}),l=l.join("&"),r=r+this.paramChar(r)+l},popupShareAction:function(e,t){var s=h.tools[e],i=s.width?s.width:h.common.defaultWidth,n=s.height?s.height:h.common.defaultHeight,a=this.buildUrl(e,t);window.open(a,e+"Share","toolbar=0,status=0,height="+n+",width="+i+",scrollbars=yes,resizable=yes")},getTrackingParam:function(){var e=this.isUserVariant("articleSharetools"),t="smv"+e;return"string"==typeof e?t:void 0}};return m}),define("shared/sharetools/views/showall",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/ad/views/ads","shared/sharetools/templates","shared/sharetools/helpers/sharetools-config","shared/sharetools/helpers/sharetools-mixin","shared/sharetools/views/email","foundation/models/user-data","shared/sharetools/instances/short-url"],function(e,t,s,i,n,a,o,l,r,d,c){var h=s.extend(t.extend({},l,{events:{"click .sharetool":"handleLinkClick","click .short-url-input, .text":"handleInputSelect"},className:"show-all-view-container",defaultModalSettings:{id:"show-all-sharetool-modal",modalTitle:"share this video",binding:".show-all-sharetool",tailDirection:"up",hasOverlay:!1,hasCloseButton:!1,positionTailSide:!1,autoPosition:!1,modalContent:"",tailLeftOffset:0,tailTopOffset:0,template:"showAllSharetoolModal",openCallback:function(){this.$target.addClass("active")},closeCallback:function(){this.$target.removeClass("active"),this.removeFromPage()}},articleTools:["save","print","reprints"],initialize:function(e,s){var i;t.bindAll(this,"handleShortUrl"),this.settings=t.extend({},this.getDataAttrs(!0,s)),this.modalSettings=t.extend({},this.defaultModalSettings,e),this.isMobileSharetools()&&(this.modalSettings=t.extend({},this.modalSettings,{tailDirection:"centered",hasCloseButton:!0,hasOverlay:!0,positionTailSide:!1,autoPosition:!1})),i=this.createAnchor(this.settings.url),i.search+=0===i.search.indexOf("?")?"&":"?",i.search+="smid=pl-share",this.settings.permalinkUrlWithSmid=i.href,this.settings.shortUrl=c.requestUrl(this.settings.permalinkUrlWithSmid)||"",this.settings.shortUrl||this.listenToOnce(c,"add",this.handleShortUrl),this.render(),this.trackingBaseData={module:"ShareTools",action:"click",contentCollection:this.pageManager.getMeta("article:section")}},render:function(){var e=this.settings.ad?"Frame6A":"";this.modalSettings.modalContent=a[this.modalSettings.template](this.buildShareHTML()),this.showAllModal=new i(this.modalSettings),this.setElement(this.showAllModal.$modal),this.showAllModal.$modal.find(".show-all-sharetool-modal-ad").attr("id",e),this.showAllModal.addToPage(),this.settings.ad&&this.pageManager.getCurrentBreakpoint()>=1e3&&new n({positions:[e],scope:"modal",autoconfirm:0}),this.settings.embedCode&&this.handleEmbedCode()},buildShareHTML:function(){for(var e,s=this.settings.inlineTools,i="",n="",l=0,r=s.length;r>l;l+=1)e=a.showallLinks({shareObj:s[l],config:o.tools[s[l].type]}),t.indexOf(this.articleTools,s[l].type)>=0?n+=e:i+=e;return{shortUrl:this.settings.shortUrl,showAllLinkList:i,showAllToolList:n}},handleShortUrl:function(){var e=c.findWhere({url:this.settings.permalinkUrlWithSmid});e&&(this.settings.shortUrl=e.get("shortUrl"),this.showAllModal.$modal.find(".short-url-input").val(this.settings.shortUrl))},handleEmbedCode:function(){this.settings.embedCode&&this.showAllModal.$modal.find(".embed-input").val(this.settings.embedCode)},handleInputSelect:function(e){e.target.select()},handleLinkClick:function(t){var s=e(t.target),i=s.data("share")||s.parent().data("share"),n="popup"===o.tools[i].postType?"popup":i;this.showAllModal.close();var a={version:this.settings.contentType||"Content",region:"ToolsMenu"};switch("save"===i||"reprints"===i||"print"===i?(a.module="ArticleTools",a.eventName="ArticleTool-"+i):a.eventName="Share-"+i,this.trackingTrigger("share-tools-click",a),n){case"email":this.isMobileSharetools()?this.openMailToLink():d.isLoggedIn()&&new r({dataUrl:this.settings.url});break;case"popup":"twitter"===i?this.handleShortUrlShareAction(o.tools[i]):this.popupShareAction(i);break;case"save":this.saveAction();break;case"reprints":this.popupShareAction(i);break;case"print":window.print()}}}));return h}),define("shared/sharetools/views/sharetools",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/sharetools/templates","shared/sharetools/views/email","shared/sharetools/views/showall","shared/sharetools/instances/cross-platform-save","foundation/models/user-data","shared/sharetools/helpers/sharetools-config","shared/sharetools/helpers/sharetools-mixin"],function(e,t,s,i,n,a,o,l,r,d){var c=s.registerView("sharetools").extend(t.extend({},d,{events:{"click .sharetool":"handleShareAction"},defaultModalData:{shares:"facebook|Share,email|Email,twitter|Tweet,linkedin|LinkedIn,google|Google+,reddit|Reddit,save|Save,reprints|Reprints,print|Print,ad"},initialize:function(e){0===this.$el.length||this.$el.hasClass("sharetools-init")||(this.settings=t.extend({},this.getDataAttrs(),e),this.modalSettings=t.extend({},e.showAllModalSettings),this.modalData=t.extend({},this.$el.data(),this.defaultModalData,e.showAllModalData),this.$el.addClass("sharetools"),this.setUpConfigOptions(),this.render(),this.trackingBaseData={module:"ShareTools",version:this.$el.data("content-type")||"Content",action:"click",contentCollection:this.pageManager.getMeta("article:section"),pgtype:this.pageManager.getMeta("PT")})},render:function(){var t,s=(this.$el.find(".middle-left-ad"),this.$el.find(".sharetools-inline-article-ad")),n=i.shareTools({shares:this.settings.inlineTools,config:r.tools});return this.$el.addClass("sharetools-init"),s.length>0?e(n).insertBefore(this.$el.find(".sharetools-inline-article-ad")):this.$el.append(n),this.settings.ad&&(t=this.pageManager.getCurrentBreakpoint()<=1020?"Position1":"Frame4A",this.$el.find(".sharetools-inline-article-ad").attr("id",t),this.broadcast("nyt:ads-new-placement",t)),this.runABTest(),this},handleShareAction:function(t){var s=e(t.target),i=s.data("share")||s.parent().data("share"),o="popup"===r.tools[i].postType?"popup":i,d=this.trackingBaseData;switch(s.parents(".video-player-region").size()>0?d.region="video-player-region":s.parents("#main").size()>0?d.region="Body":s.parents("#masthead").size()>0&&(d.region="TopBar"),"show-all"===i?d.eventName="Share-ShowAll":"save"===i||"reprints"===i||"print"===i?(d.module="ArticleTools",d.eventName="ArticleTool-"+i):d.eventName="Share-"+i,this.trackingTrigger("share-tools-click",d),o){case"email":this.isMobileSharetools()?this.openMailToLink():l.isLoggedIn()&&new n({dataUrl:this.settings.url});break;case"save":this.saveAction();break;case"popup":"twitter"===i?this.handleShortUrlShareAction(r.tools[i]):this.popupShareAction(i);break;case"embed":t.stopPropagation(),this.$(".show-all-sharetool a").trigger("click"),this.$body.find(".show-all-sharetool-modal #embed-input").select();break;case"show-all":new a(this.modalSettings,this.modalData)}},changeActiveState:function(){this.$(".show-all-sharetool").hasClass("active")?this.$(".show-all-sharetool").removeClass("active"):this.$(".show-all-sharetool").addClass("active")},runABTest:function(){var t="articleSharetools",s=this.isUserVariant(t),i=e(".sharetools .facebook-sharetool .sharetool-text"),n=e(".sharetools .twitter-sharetool .sharetool-text");("2"===s||"3"===s||"6"===s||"7"===s)&&("facebook"===i.text()&&i.text("share"),"twitter"===n.text()&&n.text("tweet")),("4"===s||"5"===s||"6"===s||"7"===s)&&e("#sharetools-masthead .show-all-sharetool .sharetool-text").text("More")}}));return c}),define("topic/instances/sharetools",["jquery/nyt","shared/sharetools/views/sharetools"],function(e,t){var s;new t({el:e("#sharetools-story"),showAllModalSettings:{tailDirection:"left",tailLeftOffset:-8,tailTopOffset:2,positionTailSide:!0,autoPosition:!0,toggleSpeed:1,openCallback:function(){var e=this,t=this.pageManager.getViewport().top;s=function(){Math.abs(t-this.pageManager.getViewport().top)>300&&e.close()},this.listenTo(this.pageManager,"nyt:page-scroll",s),this.$target.addClass("active")},closeCallback:function(){this.stopListening(this.pageManager,"nyt:page-scroll",s),this.$target.removeClass("active"),this.removeFromPage()}}}),new t({el:e("#sharetools-masthead"),showAllModalSettings:{tailDirection:"up-right",tailLeftOffset:0,tailTopOffset:-10,fixedOverride:!0,positionTailSide:!1,toggleSpeed:1,openCallback:function(){this.listenToOnce(this.pageManager,"nyt:masthead-storytheme",function(){this.close()})}}})}),define("topic/instances/timeline",["jquery/nyt"],function(e){var t=5,s=10,i=e("#timelineModule ol"),n=e("#showMore"),a=e(".applicationButton.timelineLoading"),o=i.find("li").length;n.on("click",function(){var e=i.find(".hide"),l=e.length,r=i.height(),d=i.find(".item.lastItem"),c=t>o?o:o-l,h=l>=s?s:l;n.addClass("hide"),a.removeClass("hide"),d.removeClass("lastItem"),e.eq(h-1).addClass("lastItem").prevAll(".hide").andSelf().removeClass("hide");var u=i.height("auto").height();i.height(r).animate({height:u+"px"},2e3,function(){a.addClass("hide"),o>c+h?n.removeClass("hide"):(i.find(".timelineEnd").removeClass("hide"),i.find(".item.lastItem").addClass("noBackground"))})})}),define("topic/views/article-well/utils",["jquery/nyt","underscore/nyt"],function(e,t){var s=t.extend({},{dayNames:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],sendAddQuery:function(t,i,n){e("#wellPanelOverlay").toggle(),e.ajax({type:"GET",url:t,cache:!0,data:""}).done(function(e){if(e&&e.response&&e.response.meta){var t=0;e.response.meta.hits&&(t=e.response.meta.hits),i&&(n?i(t,n):i(t)),e.response.docs&&s.displaySearchResults(e.response.docs)}}).fail(function(t){var s="";try{s=JSON.stringify(e.parseJSON(t.responseText).errors)}catch(i){s=t.responseText}console.debug(s)}).always(function(){e("#wellPanelOverlay").toggle()})},displaySearchResults:function(t){if(t){if(e("#searchResults").length<=0)return s.displayTravelResults(t),void 0;for(var i="",n=JSON.parse(e("#wellOptions").text()),a=0;a<t.length;a++)if(t[a].web_url){var o=null,l=null;if(t[a].multimedia)for(var r=0;r<t[a].multimedia.length;r++)t[a].multimedia[r].subtype&&("thumbnail"===t[a].multimedia[r].subtype?(o=t[a].multimedia[r].url,"http"!==o.substring(0,4)&&(o="http://static01.nyt.com/"+o)):"wide"===t[a].multimedia[r].subtype&&(l=t[a].multimedia[r].url,"http"!==l.substring(0,4)&&(l="http://static01.nyt.com/"+l)));if(i+='<div class="story clearfix">',t[a].headline.kicker&&n.show_kicker===!0&&(i+='<h6 class="kicker">'+t[a].headline.kicker+"</h6>"),o&&n.show_thumbnails===!0&&(i+='<div class="callout thumbnail"><a href="'+t[a].web_url+'"><img border="0" src="'+o+'"></a></div>',i+='<div class="callout wide"><a href="'+t[a].web_url+'"><img border="0" src="'+l+'"></a></div>'),i+='<h4><a href="'+t[a].web_url+'" title="'+t[a].headline.main+'" class="inTextRefer">'+t[a].headline.main+"</a></h4>",t[a].byline&&n.show_byline===!0&&(i+='<div class="byline">'+t[a].byline+"</div>"),t[a].snippet&&n.show_summary===!0&&(i+='<p class="summary">'+t[a].snippet+"</p>"),t[a].pub_date&&n.show_pub_date===!0){var d=new Date(t[a].pub_date);i+='<h6 class="date">'+s.monthNames[d.getUTCMonth()]+" "+d.getUTCDate()+", ",i+=d.getUTCFullYear()+", "+s.dayNames[d.getDay()]+"</h6>"}if(n.more_on_header&&n.show_related_topics===!0){i+='<div id="moreOn" class="moreOn"> ',i+=n.more_on_header+"&nbsp;";for(var c,h=0;h<t[a].keywords.length;h++)c=t[a].keywords[h],i+='<a rel="nofollow" value="'+c.name+'" href="'+c.value+'">'+c.value+"</a>",h+1!==t[a].keywords.length&&(i+=", ");i+="</div>"}i+="</div><!-- close story clearfix -->"}e("#searchList").html(i)}},displayTravelResults:function(t){for(var i="",n=0;n<t.length;n++)if(t[n].web_url){var a=null;if(t[n].multimedia)for(var o=0;o<t[n].multimedia.length;o++)t[n].multimedia[o].subtype&&"wide"===t[n].multimedia[o].subtype&&(a=t[n].multimedia[o].url,"http"!==a.substring(0,4)&&(a="http://static01.nyt.com/"+a));i+='<li><article class="story theme-summary',null===a&&(i+=" no-thumb"),i+='">',i+='<header class="story-header">';var l="";if(t[n].created?l=new Date(t[n].created):t[n].pub_date&&(l=new Date(t[n].pub_date)),l){var r=s.monthNames[l.getUTCMonth()]+" "+l.getUTCDate()+", "+l.getUTCFullYear();i+='<span><time class="dateline">'+r+"</time></span>"}t[n].headline.kicker&&(i+='\n<span class="kicker">'+t[n].headline.kicker+"</span>"),i+="</header>",i+='<div class="story-body">',i+='<h2 class="story-heading">',i+='<a class="story-link" data-rref="" href="'+t[n].web_url+'">'+t[n].headline.main+"</a>",i+="</h2>",t[n].byline&&(i+='<p class="byline">'+t[n].byline+"</p>"),i+='<p class="summary">'+t[n].snippet+"</p>",i+="</div>",null!==a&&(i+='<footer class="story-footer">',i+='<div class="wide-thumb">',i+='<a class="story-link" aria-hidden="true" role="presentation" tabindex="-1" href="'+t[n].web_url+'">',i+='<img role="presentation" src="'+a+'" alt="'+t[n].headline.main+'"/>',i+="</a>",i+="</div>",i+="</footer>"),i+="</article></li>"}""===i&&(i='<li><div class="zero-hits">No articles found. Try refining your search.</div></li>'),e("ol.story-menu").html(i)}});return s}),define("topic/views/article-well/article-well",["jquery/nyt","underscore/nyt","foundation/views/base-view","topic/views/article-well/utils","topic/templates","foundation/lib/bootpag/1.0.4"],function(e,t,s,i,n){var a=s.extend(t.extend({},{el:e("#wellPanel"),events:{"keyup .search-input":"handleKeyUp","keydown .search-input":"handleKeyDown","click .submit-button":"submitSearch","click .clear-button":"handleClearButton","click .search-tab":"handleSearchTab","click .latest-tab":"handleLatestTab"},templates:n,ENTER:13,ESC:27,pageSize:10,hashOrder:["s","page","query","moreon"],initialize:function(){t.bindAll(this,"handleReset","handleResetRelated","handleRelatedTopic","submitSearch","searchCallback"),t.bindAll(this,"setupSort","setupBootpag","handleSort","buildQuery","displaySearchStats","urlCallback")},handleDomReady:function(){this.$input=this.$el.find(".search-input"),this.$clearButton=this.$el.find(".clear-button"),this.$submitButton=this.$el.find(".submit-button"),this.$searchStats=this.$el.find(".search-stats"),this.$relatedQuery=this.$el.find(".related-query"),this.$relatedTerm=this.$el.find(".related-term"),this.$wellQuery=e("#wellQuery").text(),this.$wellHits=e("#wellHits").text(),this.$pageMsg=e("#pageMsg"),e(document).on("click","#resetWell",this.handleReset),e(document).on("click","#resetRelated",this.handleResetRelated),e(document).on("click",".moreOn a",this.handleRelatedTopic);for(var t=window.location.search.substring(1),s=t.split("&"),i={},n=0;n<s.length;n++){var a=s[n].split("=");i[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}"s"in i||"query"in i||"offset"in i||"moreon"in i?this.handleUrlParams(i):(this.setupBootpag(),this.$submitButton.addClass("disabled"),this.setupSort())},handleUrlParams:function(t){var s="";t.showStats=!1;var n=1;if("page"in t&&t.page>0&&t.page<=100?n=t.page:"offset"in t&&t.offset>0&&t.offset<=1e3&&t.offset<=parseInt(e("#wellHits").text(),this.pageSize)&&(n=Math.ceil(t.offset/this.pageSize),s+="&page="+(n-1)),t.page=n,"s"in t&&"oldest"===t.s&&(s+="&sort="+t.s),this.setupSort(t.s),"moreon"in t){var a=t.moreon.split(":");2===a.length&&(this.handleRelatedTopic(!1,t.moreon),t.showStats=!0)}"query"in t?(this.setSearchValue(t.query),s+="&q="+t.query,t.showStats=!0):this.$submitButton.addClass("disabled"),i.sendAddQuery(this.buildQuery()+s,this.urlCallback,t)},urlCallback:function(t,s){if(t>0){var i=!1,n="";if("offset"in s&&s.offset>1e3?(n+='<div id="urlErrorMsg"><span style="color:red;">Your offset ('+s.offset+") ",n+="exceeds the maximum viewing range (1000).</span>",n+=' <a rel="nofollow" id="resetWell"><strong>(Clear)</strong></a></div>',i=!0):("offset"in s&&s.offset>t||s.page>Math.ceil(t/this.pageSize))&&(n='<div id="urlErrorMsg"><span style="color:red;">Your offset ('+s.offset+") ",n+="exceeds the number of matching articles ("+t+"). </span>",n+=' <a rel="nofollow" id="resetWell"><strong>(Clear)</strong></a></div>',i=!0),i)return this.$searchStats.html(n),this.$searchStats.is(":hidden")&&this.$searchStats.fadeToggle(),this.setupSort(s.s),this.setupBootpag(0),void 0}this.setupBootpag(t,s.page),100===s.page&&(e(".bootpag li.next").hide(),this.$pageMsg.show()),this.setupSort(s.s),s.showStats&&this.displaySearchStats(t)},setupBootpag:function(t,s){var n=this,a=0,o=this.$el.find(".page-num");if(this.$pageMsg.hide(),(void 0===s||isNaN(s))&&(s=1),0!==t){(void 0===t||isNaN(t))&&(t=this.$wellHits),a=Math.ceil(t/this.pageSize);var l=Math.min(10,a),r="next <span>&#8594;</span>",d="<span>&#8592;</span> prev";e(".story-tabs").length&&(l=0,r='<button class="button older">Next<div class="arrow arrow-right"><div class="arrow-conceal"></div></div></button>',d='<button class="button newer"><div class="arrow arrow-left"><div class="arrow-conceal"></div></div>Previous</button>'),o.unbind("page").bootpag({total:a,page:s,maxVisible:l,leaps:!1,next:r,prev:d}).on("page",function(t,s){var a=e(".sort a.active").attr("value"),o=n.buildQuery()+"&page="+(s-1)+a;e("#urlErrorMsg").hide(),100===s?(e(".bootpag li.next").hide(),e("#pageMsg").show()):(e("#pageMsg").hide(),e(".bootpag li.next").show()),e(".story-tabs").length?(e("html,body").animate({scrollTop:e(".story-tabs").offset().top-60},500),e("#SponLink").hide(),e("ol.story-menu").fadeOut(500),i.sendAddQuery(o),e("ol.story-menu").fadeIn(800),e("#SponLink").show()):i.sendAddQuery(o)})}else if(e(".story-tabs").length)o.html("");else{var c='<ul class="bootpag">';c+='<li data-lp="1" class="prev active"><a href="javascript:void(0);"><span>&#8592;</span> prev</a></li>',c+='<li data-lp="2" class="next active"><a href="javascript:void(0);">next <span>&#8594;</span></a></li>',c+="</ul>",o.html(c)}},setupSort:function(t){t="undefined"==typeof t?"newest":t,this.$el.find(".sort a").unbind("click"),this.$el.find(".sort a").on("click",this.handleSort),"oldest"===t?(e("#sortNewest").removeClass("active"),e("#sortOldest").addClass("active")):e("#sortNewest").hasClass("active")||(e("#sortNewest").addClass("active"),e("#sortOldest").removeClass("active"))},handleSort:function(t){t&&t.preventDefault();var s=e(t.target);e("#urlErrorMsg").hide(),s.hasClass("active")||(s.toggleClass("active"),s.siblings().toggleClass("active"));var n=this.buildQuery()+s.attr("value");i.sendAddQuery(n),""!==this.$searchStats.text()?this.setupBootpag(this.$searchStats.find(".hits").text()):this.setupBootpag()},handleReset:function(t){if(t&&t.preventDefault(),this.setSearchValue(""),this.$clearButton.fadeOut(200),this.$searchStats.is(":visible")&&this.$searchStats.fadeToggle().empty(),this.$relatedTerm.empty(),this.$relatedQuery.empty(),this.$submitButton.hasClass("disabled")||this.$submitButton.addClass("disabled"),i.sendAddQuery(this.$wellQuery),e(".story-tabs").length){var s=this.$wellHits+" articles";
this.$el.find(".control .stats").html(s)}this.setupBootpag(),this.setupSort()},handleResetRelated:function(e){e.preventDefault(),this.$relatedTerm.empty(),this.$relatedQuery.empty(),this.$pageMsg.hide(),i.sendAddQuery(this.buildQuery(),this.searchCallback)},handleRelatedTopic:function(t,s){var n="",a="";if(t){t.preventDefault();var o=e(t.target);n=o.attr("value"),a=o.text()}else{if(!s)return;var l=s.split(":");n=l[0],a=l[1]}for(var r=this.$wellQuery.split("&"),d=0;d<r.length;d++){var c=r[d].split("=",2);"fq"===c[0]&&(r[d]="fq=("+c[1]+") AND "+n+':"'+a+'"')}var h=r.join("&");this.$relatedQuery.text(h),this.$relatedTerm.html(a),t&&(""!==this.getSearchValue()&&(h+="&q="+this.getSearchValue()),i.sendAddQuery(h,this.searchCallback),this.$submitButton.hasClass("disabled")&&this.$submitButton.removeClass("disabled"),e("html,body").animate({scrollTop:e("#searchResults").offset().top-40},"slow"))},submitSearch:function(e){e&&e.preventDefault(),this.getSearchValue()&&i.sendAddQuery(this.buildQuery(),this.searchCallback)},searchCallback:function(e){this.setupBootpag(e),this.setupSort(),this.displaySearchStats(e)},displaySearchStats:function(t){var s="";return e(".story-tabs").length?(s=t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" articles",this.$el.find(".control .stats").html(s),void 0):(s="Your search for ",""!==this.getSearchValue()?(s+="<strong>"+this.getSearchValue()+"</strong>",""!==this.$relatedTerm.text()&&(s+=" and <strong>"+this.$relatedTerm.text()+'</strong> (<a rel="nofollow" id="resetRelated">X</a>)')):""!==this.$relatedTerm.text()&&(s+="<strong>"+this.$relatedTerm.text()+"</strong>"),s+=' returned <span class="hits"><strong>'+t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</strong></span> articles. ",s+=' <a rel="nofollow" id="resetWell"><strong>Clear Results</strong></a>',this.$searchStats.html(s),this.$searchStats.is(":hidden")&&this.$searchStats.fadeToggle(),void 0)},buildQuery:function(){var t=""!==this.$relatedQuery.text()?this.$relatedQuery.text():this.$wellQuery;return""!==this.getSearchValue()&&(t+="&q="+this.getSearchValue(),e(".story-tabs").length&&(t+="&offset=0")),t},handleClearButton:function(e){e.preventDefault(),this.$input.focus(),this.handleReset()},handleSearchTab:function(){e("#travel-search").removeClass("hidden"),e("#wellPanel .search-tab").addClass("active"),e("#wellPanel .latest-tab").removeClass("active")},handleLatestTab:function(){e("#travel-search").addClass("hidden"),e("#wellPanel .latest-tab").addClass("active"),e("#wellPanel .search-tab").removeClass("active"),this.$searchStats.fadeToggle().empty(),this.handleReset()},handleKeyDown:function(e){var t=e.which;t===this.ENTER&&e.preventDefault()},handleKeyUp:function(e){e.preventDefault();var t=e.which;t===this.ENTER?this.submitSearch():t===this.ESC?this.handleReset():(this.$clearButton[this.getSearchValue().length>0?"fadeIn":"fadeOut"](200),this.getSearchValue().length?this.$submitButton.hasClass("disabled")&&this.$submitButton.removeClass("disabled"):(this.$submitButton.addClass("disabled"),this.handleReset()))},getSearchValue:function(){return e.trim(this.$input.val())},setSearchValue:function(e){this.$input.val(e)}}));return a}),define("topic/instances/article-well",["jquery/nyt","topic/views/article-well/article-well"],function(e,t){new t}),define("topic/instances/utils",["jquery/nyt"],function(e){function t(e){var t="";document.getElementById?(t=document.getElementById(e).style,t.display=t.display?"":"block"):document.all?(t=document.all[e].style,t.display=t.display?"":"block"):document.layers&&(t=document.layers[e].style,t.display=t.display?"":"block")}function s(e){var t="";document.getElementById?(t=document.getElementById(e).style,t.display=t.display?"":"none"):document.all&&(t=document.all[e].style,t.display=t.display?"":"none")}e(".showhidetxt a").click(function(e){e.preventDefault();var i="moretxt",n="more";"Hide"===e.title&&(i="more",n="moretxt"),t(i),s(n)})}),define("shared/masthead/templates",["underscore/nyt"],function(_){var templates={};return templates.profileIcon=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<span class="avatar" role="presentation">\n<a href="http://timespeople.nytimes.com/view/user/'+(null==(__t=userData.getUserId())?"":__t)+'/settings.html"><img src="'+(null==(__t=userData.getImageUrl())?"":__t)+'" alt="" /></a>\n</span>';return __p},templates.userName=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<button class="button user-name-button">\n<span class="button-text">'+(null==(__t=getTruncatedUserName(15))?"":__t)+'</span>\n<i class="icon user-icon"></i>\n<i class="icon caret-icon"></i>\n</button>';return __p},templates.userNameModalContent=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul>\n<li><a href="http://timespeople.nytimes.com/view/user/'+(null==(__t=userData.getUserId())?"":__t)+'/settings.html">My Profile</a></li>\n<li><a href="'+(null==(__t=hosts.myaccount)?"":__t)+'/membercenter/myaccount.html">My Account</a></li>\n<li><a href="'+(null==(__t="http:"+hosts.www)?"":__t)+'/saved">My Saved Items</a></li>\n<li><button class="button log-out-button">Log Out</button></li>\n</ul>';return __p},templates.userNameModalTitle=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",""!=userData.getImageUrl()&&(__p+='<span class="avatar">\n<a href="http://timespeople.nytimes.com/view/user/'+(null==(__t=userData.getUserId())?"":__t)+'/settings.html"><img src="'+(null==(__t=userData.getImageUrl())?"":__t)+'" /></a>\n</span>'),__p+='\n<span class="user-name-subscription">\n<span class="user-name">'+(null==(__t=userData.getUserName())?"":__t)+'</span>\n<span class="user-subscription"><a href="https://myaccount.nytimes.com/membercenter/myaccount.html">'+(null==(__t=subscription.label)?"":__t)+"</a></span>\n</span>";return __p},templates.userSettingsModal=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="menu edition-menu">\n<h5 class="modal-heading">Edition</h5>\n<ul>\n<li><a href="http://www.nytimes.com" data-edition="us">U.S.</a></li>\n<li><a href="http://global.nytimes.com" data-edition="global">International</a></li>\n<li><a href="http://cn.nytimes.com" data-edition="chinese">中文 (Chinese)</a></li>\n</ul>\n</div>\n<div class="menu help-menu">\n<h5 class="modal-heading">Help</h5>\n<ul>\n<li><a href="http://www.nytimes.com/content/help/front.html">FAQ</a></li>\n<li><a href="http://www.nytimes.com/content/help/contact/directory.html">Contact Us</a></li>\n</ul>\n</div>\n',showTypeSizer&&(__p+='\n<div class="menu type-sizer-menu">\n<h5 class="modal-heading">Type Size</h5>\n<ul>\n<li data-size="small" class="type-sizer-small"><a href="javascript:;">A <span class="visually-hidden">Type size small</span></a></li>\n<li data-size="medium" class="type-sizer-medium"><a href="javascript:;">A <span class="visually-hidden">Type size medium</span></a></li>\n<li data-size="large" class="type-sizer-large"><a href="javascript:;">A <span class="visually-hidden">Type size large</span></a></li>\n</ul>\n</div>\n'),__p+="";return __p},templates}),define("shared/masthead/views/masthead",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/hosts","foundation/models/user-data","shared/masthead/templates"],function(e,t,s,i,n,a){var o=s.registerView("masthead").extend({el:"#masthead",events:{"click .home-button":"handleHomeClick","click .search-button":"handleSearchClick","click .sections-button":"handleSectionsClick","click .branding a":"handleLogoClick","click .editions-menu a":"handleEditionClick"},nytEvents:{"nyt:ribbon-visiblility":"accomodateRibbon","nyt:masthead-search-toggle":"handleSearchToggle","nyt:messaging-critical-alerts-move-furniture":"handlePageAlerts","nyt:messaging-suggestions-move-furniture":"handlePageAlerts","nyt:messaging-notification-count-update":"handleMessagingCountChange","nyt:masthead-edition-change":"handleEditionClick"},initialize:function(){this.trackingBaseData={action:"click",contentCollection:this.pageManager.getMeta("article:section"),region:"TopBar"}},handleUserReady:function(){var e=this.$el.find(".user-tools-button-group");n.isLoggedIn()?e.prepend(a.userName(n)):e.find(".login-button").removeClass("hidden")},accomodateRibbon:function(e){e?this.$el.addClass("ribbon-visible"):this.$el.removeClass("ribbon-visible")},handlePageAlerts:function(e){e(this.$el)},handleHomeClick:function(t){var s=e(t.currentTarget).closest(".home-button"),i=this.trackingAppendParams(s.data("href"),{module:"HomePage-Button"});window.location=i},handleSearchClick:function(e){this.broadcast("nyt:masthead-search-click",e),this.trackingTrigger("masthead-search-click",{module:"SearchOpen",eventName:"OpenSearchBar"})},handleSectionsClick:function(e){this.broadcast("nyt:masthead-section-click",e)},handleLogoClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"HomePage-Title"});s.attr("href",i)},handleSearchToggle:function(e){this.$el.find(".search-button")[e?"addClass":"removeClass"]("active")},handleMessagingCountChange:function(e){var t=this.$el.find(".notifications-button");e>0?(t.find(".button-text").html(e),t.addClass("new")):(t.find(".button-text").html("0"),t.removeClass("new"))},handleEditionClick:function(t){var s=e(t.target),i=s.data("edition"),n=s.attr("href");this.pageManager.setEdition(i);var a="";switch(i){case"us":a="EditionToggleToUS";break;case"global":a="EditionToggleToGlobal";break;case"chinese":a="EditionToggleToCHNS"}n=this.trackingAppendParams(n,{module:a}),s.attr("href",n)}});return o}),define("shared/masthead/views/in-story-theme",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager"],function(e,t,s,i){var n=s.extend({el:"#masthead",events:{"click .kicker":"scrollToTop","click .kicker-label a":"handleSectionClick"},nytEvents:{"nyt:page-scroll":"toggleTheme","nyt:page-scroll-after":"setSwitchPosition","nyt:page-resize":"handleResize","nyt:page-breakpoint":"handleBreakPoint","nyt:masthead-switch-change":"handleSwitchChange","nyt:masthead-position-change":"handlePositionChange"},defaultSettings:{themeClass:"in-content",switchPosition:0,shouldScrollAway:!1,currentBreakPoint:i.getCurrentBreakpoint(),metaContainer:".story-meta",contentSelector:"#story",contentSwitchPointSelector:".story-meta .kicker"},initialize:function(e){this.settings=t.extend({},this.defaultSettings,e)},handleDomReady:function(){this.isTransparent()?this.setSwitchOverrides("#story .story-body-text",!0):this.$switchSelector=e("#story").find(".story-meta .kicker"),this.$pageContainer=this.$el.find(".container"),this.$mastheadKicker=this.$el.find(".kicker"),this.setSwitchPosition(),this.toggleTheme()},handleSwitchChange:function(e,t){this.setSwitchOverrides(e,t)},handlePositionChange:function(e){this.settings.shouldScrollAway=e||!1,e||this.$el.css("position","fixed"),this.toggleTheme()},handleResize:function(){i.isDomReady()&&(this.isTransparent()?this.setSwitchOverrides("#story .story-body-text",!0):this.$switchSelector=e("#story").find(".story-meta .kicker"),this.moveMastheadKicker(),this.settings.currentBreakPoint<1010?this.removeStoryTheme():this.toggleTheme())},setSwitchOverrides:function(t,s){this.settings.shouldScrollAway=s||!1,this.$switchSelector=e(t),this.setSwitchPosition(!0),this.toggleTheme()},setSwitchPosition:function(e){this.$switchSelector.length>0&&(this.settings.switchPosition=this.$switchSelector.offset().top-this.$el.height()),e===!0&&(this.settings.overridePosition=this.settings.switchPosition)},toggleTheme:function(){var e=this.settings.overridePosition||100;this.settings.switchPosition<e&&(this.settings.switchPosition=e);var t=i.getViewport().top,s=t>this.settings.switchPosition,n=t>e,a=this.$el.hasClass(this.settings.themeClass),o="nyt:masthead-storytheme";s&&!a&&this.settings.currentBreakPoint>=1010?(this.settings.shouldScrollAway===!0&&this.$el.css("position","fixed"),this.addStoryTheme(),this.broadcast(o,!0)):!n&&a?(this.settings.shouldScrollAway===!0&&this.$el.css("position","absolute"),this.removeStoryTheme(),this.broadcast(o,!1)):a||this.settings.shouldScrollAway!==!0||this.$el.css("position","absolute")},addStoryTheme:function(){this.isTransparent()||this.$el.find(".branding").fadeOut(300).end().addClass(this.settings.themeClass),this.$el.find(this.settings.metaContainer).fadeIn(300).end().addClass(this.settings.themeClass),this.moveMastheadKicker()},removeStoryTheme:function(){this.isTransparent()||this.$el.find(".branding").stop(!1,!0).show().end().removeClass(this.settings.themeClass),this.$el.find(this.settings.metaContainer).stop().hide().end().removeClass(this.settings.themeClass)},moveMastheadKicker:function(){var e;this.$mastheadKicker&&(this.settings.currentBreakPoint>=10050&&this.settings.currentBreakPoint<10070?(e=this.$pageContainer.width()-1389,this.$mastheadKicker.css({"margin-left":Math.floor(e/2)+"px"})):10070===this.settings.currentBreakPoint?this.$mastheadKicker.css("margin-left","138px"):this.settings.currentBreakPoint<10050&&this.$mastheadKicker.css("margin-left","0px"))},scrollToTop:function(t){var s=e(t.target);s.is("a")||s.parent().is("a")||e("html, body").animate({scrollTop:0},400)},handleBreakPoint:function(e){this.settings.currentBreakPoint=e},isTransparent:function(){return this.$el.hasClass("masthead-theme-transparent")||this.$el.hasClass("masthead-theme-transparent-ffffff")?!0:void 0},handleSectionClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"SF-FixedNav",action:"click",contentCollection:this.pageManager.getMeta("article:section"),region:"TopBar"});s.attr("href",i)}});return n}),define("shared/searchform/models/search-suggest",["foundation/models/base-model"],function(e){var t=e.extend({defaults:{query:"",results:[]}});return t}),define("shared/searchform/collections/search-suggest",["backbone/nyt","foundation/collections/base-collection","foundation/views/page-manager","shared/searchform/models/search-suggest","foundation/hosts"],function(e,t,s,i,n){var a=t.extend({model:i,mobileBaseUrl:n.mobileWeb,desktopBaseUrl:n.www,settings:{numOfSuggestions:7},query:"",sync:function(t,s,i){var n="/svc/suggest/v1/homepage?query="+this.query;return i.url=this.pageManager.getCurrentBreakpoint()<120?this.mobileBaseUrl+n:this.desktopBaseUrl+n,e.sync(t,s,i)},parse:function(e){return{query:e[0],results:e[1].slice(0,this.settings.numOfSuggestions)}},newQuery:function(e){this.query=e,this.fetch()}});return a}),define("shared/searchform/templates",["underscore/nyt"],function(_){var templates={};return templates.autoSuggest=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<li><a href="'+(null==(__t=queryUrl)?"":__t)+'">\n'+(null==(__t=suggest.replace(queryRegExp,"<strong>"+query+"</strong>"))?"":__t)+"\n</a></li>";return __p},templates}),define("shared/searchform/helpers/search-form-mixin",["jquery/nyt","underscore/nyt","foundation/lib/polyfills/placeholder","shared/searchform/collections/search-suggest","shared/searchform/templates","foundation/hosts"],function(e,t,s,i,n,a){var o=t.extend({},{collection:new i,searchBaseUrl:a.search+"/search/sitesearch/#/",searchMobileUrl:a.mobileWeb+"/search?query=",KEYS:{ENTER:13,ESC:27,UP_ARROW:38,DOWN_ARROW:40,LEFT_ARROW:37,RIGHT_ARROW:39},initialize:function(){var e=this.pageManager.getMeta("article:section")||"";t.bindAll(this,"handlePageClicks"),this.trackingBaseData={action:"click",contentCollection:e,region:"TopBar"}},handleDomReady:function(){this.$list=this.$el.find(".auto-suggest"),this.$clearButton=this.$el.find(".clear-button"),this.$overlay=this.$shell.find(".search-overlay"),this.$input=this.$el.find(".search-input"),this.$submitButton=this.$el.find(".submit-button"),this.disableSubmitButton(),this.listenTo(this.collection,"sync change",this.render),this.throttledSuggestions=t.debounce(this.getAutoSuggestions,250),this.afterInitialize()},afterInitialize:e.noop,render:function(){var e,t="",s=this.collection.toJSON()[0],i=new RegExp(s.query,"ig"),a=n.autoSuggest,o=s.results.length;if(o>0&&this.getSearchValue().length>0){for(e=0;o>e;e+=1)t+=a({query:s.query,queryUrl:this.getSearchUrl(s.results[e]),suggest:s.results[e],queryRegExp:i});this.$list.show().find("ol").html(t)}else this.$list.hide()},handleKeyDown:function(e){var t=e.which;t===this.KEYS.ENTER&&e.preventDefault()},handleKeyUp:function(e){e.preventDefault();var t=e.which;t===this.KEYS.UP_ARROW||t===this.KEYS.DOWN_ARROW?this.navigateAutoSuggestions(t):t===this.KEYS.ENTER?this.handleEnterKey(e):t===this.KEYS.RIGHT_ARROW||t===this.KEYS.LEFT_ARROW?this.handleRightLeftKey(e):(this.$clearButton[this.getSearchValue().length>0?"fadeIn":"fadeOut"](200),this.getSearchValue().length?this.$submitButton.hasClass("disabled")&&this.$submitButton.removeClass("disabled"):this.disableSubmitButton(),this.throttledSuggestions())},handleEnterKey:function(){this.submitSearch()},handleRightLeftKey:e.noop,handleClearButton:function(e){e.preventDefault(),this.setSearchValue(""),this.$clearButton.fadeOut(200),this.disableSubmitButton(),this.$input.focus(),s()},setSearchValue:function(e){this.$input.val(e)},getSearchValue:function(){return e.trim(this.$input.val())},hideAutoSuggest:function(){this.$list.hide()},getAutoSuggestions:function(){var e=this.getSearchValue();e.length>1?this.collection.newQuery(e):this.hideAutoSuggest()},getSearchUrl:function(e){return this.pageManager.getCurrentBreakpoint()<120?this.searchMobileUrl+e+"&sort=rel":this.searchBaseUrl+e},navigateAutoSuggestions:function(e){var t,s;s=this.$list.find(".active"),t=s.parent().index()||0,t+=e===this.KEYS.UP_ARROW?-1:1,this.$list.find("a").removeClass("active").eq(t).addClass("active"),this.setSearchValue(this.$list.find("a").eq(t).text())},submitSearch:function(e){var t,s=this.getSearchValue();e&&e.preventDefault(),s&&(t=this.trackingAppendParams(this.getSearchUrl(s),{module:"SearchSubmit"}),this.$el.is(":visible")&&(window.location=t))},handlePageClicks:function(){this.hideAutoSuggest()},disableSubmitButton:function(){this.$submitButton.addClass("disabled")}});return o}),define("shared/masthead/views/search",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/searchform/helpers/search-form-mixin"],function(e,t,s,i){var n=s.extend(t.extend({},i,{el:e("#masthead").find(".search-flyout-panel"),events:{"click .close-button":"close","keyup .search-input":"handleKeyUp","keydown .search-input":"handleKeyDown","click .submit-button":"submitSearch","click .clear-button":"handleClearButton"},nytEvents:{"nyt:masthead-search-click":"toggle","nyt:masthead-search-toggle":"handleSearchToggle","nyt:navigation-search-click":"toggle","nyt:search-close-ready":"close"},slideTiming:100,afterInitialize:function(){this.trackingBaseData["WT.nav"]="searchWidget",this.$input.removeAttr("placeholder")},open:function(){var e=this;this.$el.slideDown(this.slideTiming,function(){e.$el.find(".control").fadeIn(e.slideTiming).end().find(".search-input").val("").focus()}),this.broadcast("nyt:masthead-search-toggle",!0),this.$shell.on("click",this.handlePageClicks),this.subscribeOnce("nyt:page-key-esc",this.close),this.$overlay.fadeIn(200),this.$html.addClass("search-active")},close:function(){var e=this;this.$html.hasClass("search-active")&&(this.$el.find(".control").fadeOut(this.slideTiming,function(){e.$el.slideUp(e.slideTiming,function(){e.$html.removeClass("search-active")})}),this.broadcast("nyt:masthead-search-toggle",!1),this.$shell.off("click",this.handlePageClicks),this.setSearchValue(""),this.$overlay.fadeOut(200))},toggle:function(){this[this.$el.is(":visible")?"close":"open"]()},isSearchButton:function(t){var s=e(t).hasClass("search-button"),i=1===e(t).parents(".search-button").length;return s||i},isSearchFlyout:function(t){var s=e(t).hasClass("search-flyout-panel"),i=1===e(t).parents(".search-flyout-panel").length;return s||i},handlePageClicks:function(e){this.isSearchButton(e.target)||this.isSearchFlyout(e.target)||this.close(),this.hideAutoSuggest()},handleSearchToggle:function(e){e===!1&&(this.$el.find(".submit-button").addClass("disabled"),this.$el.find(".clear-button").hide())}}));return n}),define("shared/masthead/views/user-settings-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/masthead/templates","foundation/cookies"],function(e,t,s,i,n){var a=s.extend({events:{"click .edition-menu a":"handleEditionClick","click .type-sizer-menu li":"handleFontSizeClick","click .help-menu a":"handleHelpMenuClick"},nytEvents:{"nyt:fontsizer-initialize":"handleFontSizeChange","nyt:fontsizer-change":"handleFontSizeChange"},defaultSettings:{id:"user-settings-modal",binding:".user-settings-button",tailDirection:"up-right",tailTopOffset:-8,tailLeftOffset:-1,width:"260px",toggleSpeed:1,showTypeSizer:!0,openCallback:function(){this.$target.addClass("active"),this.subscribeOnce("nyt:page-scroll",this.close)},closeCallback:function(){this.$target.removeClass("active")}},webTrendsNav:"user-settings-modalContainer",initialize:function(e){var s=this.pageManager.getMeta("article:section")||"";this.settings=t.extend({},this.defaultSettings,e),this.settings.modalContent=n.userSettingsModal({showTypeSizer:this.settings.showTypeSizer}),this.trackingBaseData={action:"click",region:"TopBar","WT.nav":this.webTrendsNav,contentCollection:s}},handleDomReady:function(){this.render()},render:function(){var e=new i(this.settings);this.setElement(e.$modal),e.$modal.find("a[data-edition="+this.pageManager.getEdition()+"]").addClass("selected"),e.addToPage(),this.handleFontSizeChange()},handleEditionClick:function(e){this.broadcast("nyt:masthead-edition-change",e,{"WT.nav":this.webTrendsNav})},handleHelpMenuClick:function(t){var s=e(t.target),i=s.attr("href");i&&(i=this.trackingAppendParams(i,{}),s.attr("href",i))},handleFontSizeClick:function(t){var s=e(t.currentTarget).data("size");this.broadcast("nyt:fontsizer-change",s)},handleFontSizeChange:function(e){var t="type-size-selected";e=e||this.pageManager.getMeta("fontsizer_typeSize"),this.$el.find(".type-sizer-menu li").removeClass(t),this.$el.find(".type-sizer-"+e).addClass(t)}});return a}),define("shared/masthead/views/user-name-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/masthead/templates","foundation/models/user-data","foundation/hosts"],function(e,t,s,i,n,a,o){var l=s.extend({events:{"click .premier-subscriber a":"handleUserSubscriptionClick","click li a":"handleUserOptionClick"},defaultSettings:{id:"user-name-modal",modalTitle:"",modalContent:"",binding:".user-name-button",tailDirection:"up-right",tailTopOffset:-8,tailLeftOffset:-1,width:"260px",toggleSpeed:1,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:page-scroll",this.close)},closeCallback:function(){this.$target.removeClass("active")}},initialize:function(e){t.bindAll(this,"handleLogOut"),this.settings=t.extend({},this.defaultSettings,e),this.trackingBaseData={module:"ProfileDropdown",action:"click",region:"Masthead","WT.nav":"shell"}},handleUserReady:function(){var e,t=this.getSubscriptionLabel(a);this.settings.modalTitle=n.userNameModalTitle({userData:a,subscription:t}),this.settings.modalContent=n.userNameModalContent({userData:a,hosts:o}),this.render(),e=this.$el.find(".user-subscription"),""===t.label&&e.remove(),""!==t.className&&e.addClass(t.className),""!==t.link&&e.find("a").attr("href",t.link),"NYT Now Subscriber"===t.label&&e.find("a").after('<i class="icon dot-logo-icon"></i>'),this.listenToOnce(a,"nyt:user-image-loaded",this.handleProfileImage),this.$el.on("click",".log-out-button",this.handleLogOut)},getSubscriptionLabel:function(e){var t={label:"",className:"",link:""};return e.isPremierSubscriber()?(t.label="Times Premier Subscriber",t.className="premier-subscriber",t.link="http://www.nytimes.com/times-insider"):e.isWebSubscriber()&&e.isMobileSubscriber()?t.label="All Digital Access Subscriber":e.isTabletSubscriber()&&e.isWebSubscriber()?t.label="Tablet and Web Subscriber":e.isSmartphoneSubscriber()&&e.isWebSubscriber()?t.label="Smartphone and Web Subscriber":e.isWebSubscriber()?t.label="Web Subscriber":e.isNytNowSubscriber()&&e.isCookingSubscriber()?(t.label="NYT Now & Cooking Subscriber",t.link="http://www.nytnow.com"):e.isNytNowSubscriber()&&e.isOpinionSubscriber()?(t.label="NYT Now & NYT Opinion Subscriber",t.link="http://www.nytimes.com/content/help/mobile/mobile.html"):e.isNytNowSubscriber()?(t.label="NYT Now Subscriber",t.link="http://www.nytimes.com/content/help/mobile/nyt-now/nyt-now.html"):e.isOpinionSubscriber()&&e.isCookingSubscriber()?t.label="NYT Opinion & Cooking Subscriber":e.isCookingSubscriber()?t.label="Cooking Subscriber":e.isOpinionSubscriber()?(t.label="NYT Opinion Subscriber",t.link="http://www.nytimes.com/content/help/mobile/nyt-opinion/nyt-opinion.html"):e.isCrosswordsSubscriber()&&(t.label="Crosswords Subscriber"),t},render:function(){var e=new i(this.settings);this.setElement(e.$modal),e.addToPage()},handleProfileImage:function(){var e=n.profileIcon({userData:a});this.$el.find(".modal-heading").prepend(e)},handleUserSubscriptionClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{contentCollection:"TimesPremier-InsideStory"});s.attr("href",i)},handleUserOptionClick:function(t){var s=e(t.target),i=s.text(),n=s.attr("href"),a={action:"Click",region:"TopBar","WT.nav":"shell"};n&&(i&&(a.module=i.replace(/\s/g,"")),n=this.trackingAppendParams(n,a),s.attr("href",n))},handleLogOut:function(){var e="http:"+o.www+"/logout";e=this.trackingAppendParams(e,{module:"LogOut",action:"Click",region:"TopBar","WT.nav":"shell"}),window.location=e}});return l}),define("shared/masthead/instances/masthead",["jquery/nyt","shared/masthead/views/masthead","shared/masthead/views/in-story-theme","shared/masthead/views/search","shared/masthead/views/user-settings-modal","shared/masthead/views/user-name-modal"],function(e,t,s,i,n,a){new t,new i,new n({fixedOverride:!0,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:masthead-storytheme",this.close)}}),new a({fixedOverride:!0,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:masthead-storytheme",this.close)}}),e("#masthead .kicker").text().length>1&&new s}),define("shared/account/templates",["underscore/nyt"],function(_){var templates={};return templates.logInModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="login-form-control form-control">\n<form id="login-form" class="login-form" role="form">\n<fieldset>\n<legend>Log in</legend>\n<h6 class="legend-sub-heading form-hint">Don\'t have an account? <a href="javascript:;" class="registration-modal-trigger">Register now</a></h6>\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="login-email" id="login-email-label">Email address</label>\n</div>\n<div class="field-container">\n<input type="text" id="login-email" name="login-email" class="text login-email" placeholder="Email address" aria-labelledby="login-email-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-email-description"><i class="icon"></i><span class="visually-hidden" id="clear-email-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="login-password" id="login-password-label">Password</label>\n</div>\n<div class="field-container">\n<input type="password" id="login-password" name="login-password" class="text login-password" placeholder="Password" data-type="password" aria-labelledby="login-password-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-password-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control layout-horizontal">\n<div class="control checkbox-control">\n<div class="field-container">\n<input type="checkbox" id="login-remember" name="login-remember" class="checkbox login-remember" checked="checked" aria-labelledby="login-remember-label" aria-checked="true" />\n</div>\n<div class="label-container">\n<label for="login-remember" class="checkbox-label" id="login-remember-label">Remember me</label>\n</div>\n</div>\n<p class="form-hint password-hint">\n<a href="'+(null==(__t=hosts.www)?"":__t)+'/forgot">Forgot password?</a>\n</p>\n</div><!-- close control -->\n<div class="control last-control">\n<button id="login-send-button" class="button login-button" >Log in</button>\n</div>\n</fieldset>\n</form>\n</div><!-- close registration-form-control -->';return __p},templates.registrationModal=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="registration-form-control form-control">\n<form id="registration-form" class="registration-form" role="form">\n<fieldset>\n<legend>Register</legend>\n<h6 class="legend-sub-heading form-hint">Already have an account? <a href="javascript:;" class="login-modal-trigger">Log in</a></h6>\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="register-email" id="register-email-label">Email address</label>\n</div>\n<div class="field-container">\n<input type="email" id="register-email" name="register-email" class="text register-email" placeholder="Email address" aria-labelledby="register-email-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-email-description"><i class="icon"></i><span class="visually-hidden" id="clear-email-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="register-password" id="register-password-label">Password</label>\n</div>\n<div class="field-container">\n<input type="password" id="register-password" name="register-password" class="text register-password" placeholder="Password" data-type="password" aria-labelledby="register-password-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-password-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="retype-password" id="retype-password-label">Retype Password</label>\n</div>\n<div class="field-container">\n<input type="password" id="retype-password" name="retype-password" class="text retype-password" placeholder="Retype Password" data-type="password" aria-labelledby="retype-password-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-retyped-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-retyped-password-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control layout-horizontal">\n<div class="control checkbox-control">\n<div class="field-container">\n<input type="checkbox" id="receive-offers" name="receive-offers" class="checkbox receive-offers" checked="checked" aria-labelledby="receive-offers-label" aria-checked="true" />\n</div>\n<div class="label-container">\n<label for="receive-offers" class="checkbox-label" id="receive-offers-label">Receive occasional email updates and special offers for New York Times products and services.</label>\n</div>\n</div>\n</div><!-- close control -->\n<div class="control last-control">\n<button id="register-send-button" class="button register-button">Create Account</button>\n</div>\n</fieldset>\n</form>\n</div><!-- close registration-form-control -->\n<div class="modal-footer">\n<p class="disclaimer"><a href="http://www.nytimes.com/content/help/rights/terms/terms-of-service.html">Terms of Service</a> <a href="http://www.nytimes.com/content/help/rights/privacy/policy/privacy-policy.html">Privacy Policy</a></p>\n</div>';
return __p},templates}),define("shared/account/helpers/account-modal-mixin",["jquery/nyt","underscore/nyt","foundation/lib/polyfills/placeholder"],function(e,t,s){var i={handleDefaultSubmit:function(e){e.preventDefault()},handleKeyUp:function(t){var s=e(t.target);s.parent().find(".clear-button").toggle(""!==s.val())},handleClearButton:function(t){var i=e(t.currentTarget),n=i.parent().find("input");i.toggle(!1),n.val(""),s()}};return i}),define("shared/account/views/login-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/models/user-data","shared/modal/views/modal","shared/account/templates","foundation/lib/auth/userauth","foundation/hosts","shared/account/helpers/account-modal-mixin","foundation/lib/polyfills/placeholder"],function(e,t,s,i,n,a,o,l,r,d){var c=s.extend(t.extend({},r,{events:{"click .registration-modal-trigger":"handleRegisterClick","click #login-send-button":"handleLogInButton","submit #login-form":"handleDefaultSubmit","click .clear-button":"handleClearButton","keyup .text":"handleKeyUp"},nytEvents:{"nyt:loginmodal-open":"handleOpen"},defaultSettings:{id:"login-modal",addlClasses:"account-modal",modalContent:a.logInModal({hosts:l}),binding:".login-modal-trigger",tailDirection:"fixed",hasCloseButton:!0,hasOverlay:!0,tailLeftOffset:-40,tailTopOffset:-40},initialize:function(e){var s=this;this.modalSettings=t.extend({},this.defaultSettings,e),this.modalSettings.openCallback=function(){var e=s.modalTitle||this.$target.data("modal-title")||"Log in";s.hasPlaceholderSupport&&this.$modal.find(".login-email").focus(),this.$modal.find("legend").text(e),this.$modal.find(".field-container input").val(""),s.modalTitle=null},this.subscribe("nyt:modal-show-login-modal",d)},handleDomReady:function(){this.render()},render:function(){this.logInModal=new n(this.modalSettings).addToPage(),this.setElement(this.logInModal.$modal),this.local(this,"nyt:modal-login-modal-rendered")},handleOpen:function(e){e&&e.modalTitle&&(this.modalTitle=e.modalTitle),this.logInModal&&this.logInModal.open()},handleUserReady:function(){i.isLoggedIn()&&(this.logInModal?(this.logInModal.removeFromPage(),this.remove()):this.subscribeOnce(this,"nyt:modal-login-modal-rendered",this.handleUserReady))},handleRegisterClick:function(){this.logInModal.close(),this.trackingTrigger("loginmodal-register-click",{module:"Registration",action:"Click","WT.z_ract":"Regnow"})},handleLogInButton:function(){this.executeLogin()},executeLogin:function(){o.login({user:this.$el.find(".login-email").val(),password:this.$el.find(".login-password").val(),remember:this.$el.find(".login-remember").is(":checked")})}}));return c}),define("shared/account/views/registration-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/account/templates","foundation/lib/auth/userauth","shared/account/helpers/account-modal-mixin","foundation/lib/polyfills/placeholder"],function(e,t,s,i,n,a,o,l){var r=s.extend(t.extend({},o,{events:{"click .login-modal-trigger":"handleLoginClick","click #register-send-button":"handleRegistrationButton","submit #registration-form":"handleDefaultSubmit","click .clear-button":"handleClearButton","keyup .text":"handleKeyUp"},defaultSettings:{id:"registration-modal",addlClasses:"account-modal",modalContent:n.registrationModal(),binding:".registration-modal-trigger",tailDirection:"fixed",hasCloseButton:!0,hasOverlay:!0,tailLeftOffset:-40,tailTopOffset:-40},initialize:function(e){var s=this;this.modalSettings=t.extend({},this.defaultSettings,e),this.modalSettings.openCallback=function(){var e=this.$target.data("modal-title")||"Register";s.hasPlaceholderSupport&&this.$modal.find(".register-email").focus(),this.$modal.find("legend").text(e),this.$modal.find(".field-container input").val("")},this.subscribe("nyt:modal-show-registration-modal",l)},handleDomReady:function(){this.render()},render:function(){this.registrationModal=new i(this.modalSettings).addToPage(),this.setElement(this.registrationModal.$modal)},handleLoginClick:function(){this.registrationModal.close()},handleRegistrationButton:function(){this.executeRegistration()},executeRegistration:function(){a.register({email:this.$el.find(".register-email").val(),password:this.$el.find(".register-password").val(),confPassword:this.$el.find(".retype-password").val(),specialOffers:this.$el.find(".receive-offers").is(":checked")})}}));return r}),define("shared/account/instances/account",["shared/account/views/login-modal","shared/account/views/registration-modal","foundation/models/user-data"],function(e,t,s){s.isLoggedIn()||(new e,new t)}),define("shared/navigation/templates",["underscore/nyt"],function(_){var templates={};return templates.mobileNav=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<section class="edition-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li class="'+(null==(__t="global"!==pageManager.getEdition()?"active":"")?"":__t)+'"><a href="http://mobile.nytimes.com/"><span>U.S. Edition</span></a></li>\n</ul>\n<ul class="menu">\n<li class="'+(null==(__t="global"===pageManager.getEdition()?"active":"")?"":__t)+'"><a href="http://mobile.nytimes.com/international/"><span>International Edition</span></a></li>\n</ul>\n</section>\n<section class="primary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/"><span>Home</span></a></li>\n<li><a href="http://mobile.nytimes.com/world/"><span>World</span></a></li>\n<li><a href="http://mobile.nytimes.com/national/"><span>U.S.</span></a></li>\n<li><a href="http://mobile.nytimes.com/politics/"><span>Politics</span></a></li>\n<li><a href="http://mobile.nytimes.com/nyregion/"><span>N.Y. / Region</span></a></li>\n<li><a href="http://mobile.nytimes.com/business/"><span>Business Day</span></a></li>\n<li><a href="http://mobile.nytimes.com/technology/"><span>Technology</span></a></li>\n<li><a href="http://mobile.nytimes.com/sports/"><span>Sports</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/opinion/"><span>Opinion</span></a></li>\n<li><a href="http://mobile.nytimes.com/science/"><span>Science</span></a></li>\n<li><a href="http://mobile.nytimes.com/health/"><span>Health</span></a></li>\n<li><a href="http://mobile.nytimes.com/arts/"><span>Arts</span></a></li>\n<li><a href="http://mobile.nytimes.com/style/"><span>Style</span></a></li>\n<li><a href="http://mobile.nytimes.com/photos/"><span>Photos</span></a></li>\n<li><a href="http://mobile.nytimes.com/video/"><span>Video</span></a></li>\n<li><a href="http://mobile.nytimes.com/most-emailed/"><span>Most Emailed</span></a></li>\n</ul>\n</section>\n<section class="secondary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/automobiles/"><span>Automobiles</span></a></li>\n<li><a href="http://mobile.nytimes.com/blogs/"><span>Blogs</span></a></li>\n<li><a href="http://mobile.nytimes.com/books/"><span>Books</span></a></li>\n<li><a href="http://mobile.nytimes.com/dining/"><span>Dining &amp; Wine</span></a></li>\n<li><a href="http://mobile.nytimes.com/education/"><span>Education</span></a></li>\n<li><a href="http://mobile.nytimes.com/garden/"><span>Home &amp; Garden</span></a></li>\n<li><a href="http://mobile.nytimes.com/magazine/"><span>Magazine</span></a></li>\n<li><a href="http://mobile.nytimes.com/movies/"><span>Movies</span></a></li>\n<li><a href="http://mobile.nytimes.com/music/"><span>Music</span></a></li>\n<li><a href="http://mobile.nytimes.com/business/media/"><span>Media &amp; Advertising</span></a></li>\n<li><a href="http://mobile.nytimes.com/obituaries/"><span>Obituaries</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/publiceditor/"><span>Public Editor</span></a></li>\n<li><a href="http://mobile.nytimes.com/realestate/"><span>Real Estate</span></a></li>\n<li><a href="http://mobile.nytimes.com/opinion/sundayreview/"><span>Sunday Review</span></a></li>\n<li><a href="http://mobile.nytimes.com/tmagazine/"><span>T Magazine</span></a></li>\n<li><a href="http://mobile.nytimes.com/television/"><span>Television</span></a></li>\n<li><a href="http://mobile.nytimes.com/theater/"><span>Theater</span></a></li>\n<li><a href="http://mobile.nytimes.com/timeswire/"><span>Times Wire</span></a></li>\n<li><a href="http://mobile.nytimes.com/travel/"><span>Travel</span></a></li>\n<li><a href="http://mobile.nytimes.com/weddings/"><span>Weddings / Celebrations</span></a></li>\n<li><a href="http://mobile.nytimes.com/corrections/"><span>Corrections</span></a></li>\n</ul>\n</section>\n<section class="tertiary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/recommendations/"><span>Recommendations</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/saved/"><span>Saved</span></a></li>\n</ul>\n</section>\n<section class="settings '+(null==(__t=userData.isLoggedIn()?"":"hidden")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><span class="label">Account:</span> '+(null==(__t=userData.getUserName())?"":__t)+'</li>\n</ul>\n</section>\n<section class="logout '+(null==(__t=userData.isLoggedIn()?"":"hidden")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/logout"><span>Log out</span></a></li>\n</ul>\n</section>\n<section class="account '+(null==(__t=userData.isLoggedIn()?"hidden":"")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://www.nytimes.com/mowweb/ftnotlog"><span>Subscribe</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="https://myaccount.nytimes.com/mobile/login/smart/index.html?EXIT_URI='+(null==(__t=encodeURIComponent(window.location))?"":__t)+'"><span>Log In</span></a></li>\n</ul>\n</section>';return __p},templates.navigationModalContent=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="secondary-container">\n'+(null==(__t=secondary)?"":__t)+'\n</div>\n<div class="tertiary-container">\n'+(null==(__t=tertiary)?"":__t)+"\n</div>";return __p},templates}),define("shared/navigation/views/navigation",["module","jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager","foundation/hosts","foundation/models/user-data","shared/modal/views/modal","shared/navigation/templates"],function(e,t,s,i,n,a,o,l,r){var d=i.registerView("navigation").extend({module:e,el:"#navigation",navTemplate:r.navigation,modalTemplate:r.navigationModalContent,events:{mouseleave:"delayedClose",mouseenter:"cancelDelayedClose","mouseenter li a":"tryPrimaryHover","mouseleave li a.expandable":"delayedModalClose","click li a":"activatePrimaryItem","click .menu a[href]":"handlePrimaryNavigationClick"},nytEvents:{"nyt:masthead-section-click":"toggle","nyt:navigation-toggle-ready":"toggle","nyt:navigation-edge-click":"open","nyt:navigation-edge-mouse-enter":"delayedOpen","nyt:navigation-edge-mouse-leave":"cancelDelayedOpen","nyt:messaging-critical-alerts-move-furniture":"moveNav","nyt:messaging-suggestions-move-furniture":"moveNav","nyt:a11y-enabled":"enableA11Nav","nyt:a11y-disabled":"disableA11yNav"},defaultSettings:{panelwidth:210,navTimeout:500,navAnimation:150,hoverTimeout:500,intentRangeLower:10,intentRangeUpper:170,maxMouseLocs:2,a11yEnabled:!1},modalSettings:{id:"navigation-modal",modalTitle:"",modalContent:"",tailDirection:"left-top",closeOnClick:!1,fixedOverride:!0,autoPosition:!0,positionTailSide:!0,toggleSpeed:1},mouseLocs:[],navIds:{REAL_ESTATE:"navId-92720057-BCB6-4BDB-9351-12F29393259F",OPINION_DOMESTIC:"navId-09736473-CB3F-4B2F-9772-3AF128ABE12D",OPINION_INTERNATIONAL:"navId-AD8090D7-4137-4D71-84C8-70DA3BD89778",MORE:"navId-more-section"},navLevels:{PRIMARY:1,SECONDARY:2,TERTIARY:3},initialize:function(e){s.bindAll(this,"tryPrimaryHover","trySecondaryHover","open","close","render","saveMousePosition","delayedOpen","delayedClose","cancelDelayedOpen","cancelDelayedClose","delayedModalOpen","delayedModalClose","cancelDelayedModalOpen","cancelDelayedModalClose","delayedPrimaryHover","cancelDelayedPrimaryHover","delayedSecondaryHover","cancelDelayedSecondaryHover","handleClickClose","handleTapClose","detectFalsePositive"),this.settings=s.extend({},this.defaultSettings,e),this.singlePanelWidth=this.settings.panelwidth+"px",this.singlePanelPartlyShut=this.settings.panelwidth-20+"px",this.isNavAnimating=!1,this.timer={},this.render(),this.$document.on("click","#navigation-modal a[href]",s.bind(this.handleModalClick,this)),this.trackingBaseData={module:"SectionsNav",action:"click",version:"BrowseTree",region:"TopBar"}},handleDomReady:function(){this.updateCrosswordSubscriptionLink()},updateCrosswordSubscriptionLink:function(){var e=o.isTabletSubscriber(),s=o.isSmartphoneSubscriber(),i=o.isHomeDeliverySubscriber(),n=o.isPremierSubscriber(),l=o.isOpinionSubscriber(),r=o.isNytNowSubscriber(),d=o.isCrosswordsSubscriber(),c=a.www+"/subscriptions/games/lp8J6KQ.html?campaignId=49W96",h=a.www+"/subscriptions/games/lp897H9.html?campaignId=49W8Y";e||s||i||n||l||r?t("#nyt-crossword").attr("href",c):d?t(".nyt-crossword").addClass("hidden"):t("#nyt-crossword").attr("href",h)},handlePrimaryNavigationClick:function(e){var s=t(e.currentTarget),i=this.trackingAppendParams(s.attr("href"),{contentCollection:t.trim(s.text())});s.attr("href",i)},handleModalClick:function(e){var s=t(e.currentTarget),i=t.trim(t("#navigation-modal").find(".secondary-container .header").text()),n=this.trackingAppendParams(s.attr("href"),{contentCollection:i+"/"+t.trim(s.text()),contentPlacement:s.closest("ul").hasClass("secondary")?2:3});s.attr("href",n)},moveNav:function(e){e(this.$el)},render:function(){var e=this,t=this.$body.find(".navigation-modal"),s=t.find(".secondary-container"),i=t.find(".tertiary-container");t.eq(0).remove(),this.modalSettings.modalContent=r.navigationModalContent({secondary:s.html(),tertiary:i.html()}),this.navigationModal=new l(this.modalSettings),this.navigationModal.addToPage(),this.navigationModal.$modal.on("mouseover",".secondary li a",e.trySecondaryHover).on("click",".secondary li a.expandable",e.activateSecondaryItem).on("mouseenter",".tertiary-container",e.cancelDelayedSecondaryHover).on("mouseenter",function(){e.cancelDelayedClose(),e.cancelDelayedModalClose(),e.cancelDelayedPrimaryHover()}).on("mouseleave",function(){e.delayedClose(),e.delayedModalClose()})},toggle:function(){this.$el.hasClass("active")?this.close():this.open()},open:function(){var e=this,t={width:e.singlePanelPartlyShut,display:"block",opacity:"0"},s={width:e.singlePanelWidth,opacity:"1"};this.isNavAnimating||this.$el.hasClass("active")!==!1||(this.$el.css(t),this.$el.toggleClass("active"),this.$html.toggleClass("navigation-active"),this.isNavAnimating=!0,this.$el.animate(s,this.settings.navAnimation,function(){e.isNavAnimating=!1,e.$body.on("click",e.handleTapClose)}),this.pageManager.isMobile()&&this.$body.css("cursor","pointer"),this.settings.a11yEnabled&&this.toggleFocusEvents(!0),this.broadcast("nyt:navigation-opened",this),this.$document.on("mousemove",this.saveMousePosition))},close:function(){var e,t,s;this.isNavAnimating||this.$el.hasClass("active")!==!0||(e=this,t=this.$el.css("marginTop"),s={width:this.singlePanelPartlyShut,opacity:"0"},this.navigationModal.close(),this.resetNav(this.navLevels.SECONDARY),this.isNavAnimating=!0,this.$el.animate(s,this.settings.navAnimation,function(){e.$el.toggleClass("active"),e.$html.toggleClass("navigation-active"),e.$body.off("click",e.handleClickClose),e.$body.off("click",e.handleTapClose),e.$el.removeAttr("style"),e.$el.css("marginTop",t),e.$el.find("a").removeClass("active"),e.isNavAnimating=!1}),this.pageManager.isMobile()&&this.$body.css("cursor",""),this.settings.a11yEnabled&&this.toggleFocusEvents(!1),this.broadcast("nyt:navigation-closed",this),this.$document.off("mousemove",this.saveMousePosition))},resetNav:function(e){var t=this.navigationModal.$modal;e===this.navLevels.SECONDARY&&t.find(".section").removeClass("active"),t.find(".secondary a").removeClass("active"),t.find(".tertiary").removeClass("active"),t.find(".modal-content").removeClass("expanded"),t.find(".section-heading a").removeClass("active")},activatePrimaryItem:function(e){var s,i,n,a,o,l,r=t(e.target).closest("a");e.stopPropagation(),r.hasClass("active")||this.isNavAnimating!==!1||(r.hasClass("expandable")?(s=this.navigationModal,i=s.$modal.find('[data-parent="'+r.attr("id")+'"]').find("li").length,n=55,a=29*i,o=a+n,r.attr("id")===this.navIds.REAL_ESTATE?o=175:r.attr("id")===this.navIds.MORE?o=553:(r.attr("id")===this.navIds.OPINION_DOMESTIC||r.attr("id")===this.navIds.OPINION_INTERNATIONAL)&&(o=357),this.cancelDelayedModalClose(),this.resetNav(this.navLevels.SECONDARY),s.$modal.height(o),e.currentTarget=e.target,s.open(e),this.moveModalArrow(),this.$el.find("a").removeClass("active").attr("aria-expanded","false"),r.addClass("active").attr("aria-expanded","true"),s.$modal.find(".secondary").removeClass("active"),l=s.$modal.find(".secondary-container .section-heading"),this.setHeadingText(r,l),s.$modal.find('[data-parent="'+r.attr("id")+'"]').addClass("active"),this.broadcast("nyt:navigation-level-one-open",s.$modal)):this.modalClose())},setHeadingText:function(e,t){e.attr("href")?t.html('<a href="'+e.attr("href")+'" tabinxdex="0" role="menuitem" class="active">'+e.text()+"</a>"):t.html(e.text())},moveModalArrow:function(){var e,s,i,n=this.navigationModal.$modal,a=12,o=18,l=39,r=this.settings.panelwidth-10;t("html").hasClass("viewport-large-70")&&(r+=t("#navigation-edge").width()),n.css("left",r+"px"),e=n.find(".modal-pointer"),e.hasClass("modal-pointer-left")?(s=Math.floor(n.outerHeight()/2)-o,e.css("top",s+"px")):e.hasClass("modal-pointer-left-top")?e.css("top",a,"px"):e.hasClass("modal-pointer-left-bottom")&&(i=n.outerHeight()-l,e.css("top",i+"px"))},activateSecondaryItem:function(e){var s,i,n=t(e.target).closest("a");n.hasClass("active")||this.isNavAnimating!==!1||(e.preventDefault(),s=this.navigationModal.$modal,n.hasClass("expandable")?(this.resetNav(this.navLevels.TERTIARY),s.find(".modal-content").addClass("expanded"),i=s.find(".tertiary-container .section-heading"),this.setHeadingText(n,i),s.find("[data-parent='"+n.attr("id")+"']").eq(0).addClass("active"),n.addClass("active").attr("aria-expanded","true"),this.broadcast("nyt:navigation-level-two-open",s.find(".tertiary-container"))):(this.resetNav(this.navLevels.TERTIARY),n.addClass("active")))},tryPrimaryHover:function(e){var s,i=t(e.target).closest("a"),n=i.hasClass("expandable");this.cancelDelayedClose(),n&&this.cancelDelayedModalClose(),this.cancelDelayedPrimaryHover(),this.$el.find("li a.active").length>0?(s=this.getAngle(this.mouseLocs[0],this.mouseLocs[1]),s>this.defaultSettings.intentRangeLower&&s<this.defaultSettings.intentRangeUpper?this.delayedPrimaryHover(e):this.activatePrimaryItem(e)):this.activatePrimaryItem(e)},trySecondaryHover:function(e){var t;this.cancelDelayedClose(),this.cancelDelayedModalClose(),this.cancelDelayedSecondaryHover(),this.navigationModal.$modal.find(".modal-content").hasClass("expanded")?(t=this.getAngle(this.mouseLocs[0],this.mouseLocs[1]),t>this.defaultSettings.intentRangeLower&&t<this.defaultSettings.intentRangeUpper?this.delayedSecondaryHover(e):this.activateSecondaryItem(e)):this.activateSecondaryItem(e)},getAngle:function(e,t){if(e&&t){var s=e.x,i=e.y,n=t.x,a=t.y,o=n-s,l=a-i,r=Math.round(180*Math.atan2(o,l)/Math.PI*10)/10;return r}return null},delayedOpen:function(){this.timer.navOpen=window.setTimeout(this.open,this.defaultSettings.navTimeout)},delayedClose:function(){this.timer.navClose=window.setTimeout(this.close,this.defaultSettings.navTimeout)},cancelDelayedOpen:function(){window.clearTimeout(this.timer.navOpen)},cancelDelayedClose:function(){window.clearTimeout(this.timer.navClose)},delayedModalOpen:function(){this.timer.modalOpen=window.setTimeout(this.navigationModal.open,this.defaultSettings.navTimeout)},delayedModalClose:function(){var e=this;this.cancelDelayedPrimaryHover(),this.cancelDelayedSecondaryHover(),this.timer.modalClose=window.setTimeout(function(){e.modalClose()},this.defaultSettings.navTimeout)},modalClose:function(){this.$el.find("a").removeClass("active"),this.navigationModal.close()},cancelDelayedModalOpen:function(){window.clearTimeout(this.timer.modalOpen)},cancelDelayedModalClose:function(){window.clearTimeout(this.timer.modalClose)},delayedPrimaryHover:function(e){var t=this;t.timer.primaryHoverIntent=window.setTimeout(function(){t.activatePrimaryItem(e)},this.defaultSettings.hoverTimeout)},cancelDelayedPrimaryHover:function(){window.clearTimeout(this.timer.primaryHoverIntent)},delayedSecondaryHover:function(e){var t=this;t.timer.secondaryHoverIntent=window.setTimeout(function(){t.activateSecondaryItem(e)},this.defaultSettings.hoverTimeout)},cancelDelayedSecondaryHover:function(){window.clearTimeout(this.timer.secondaryHoverIntent)},handleClickClose:function(e){0===t(e.target).closest("#navigation, #navigation-modal").length&&this.close()},handleTapClose:function(e){0===t(e.target).closest("#navigation, #navigation-modal").length&&this.close()},saveMousePosition:function(e){this.mouseLocs.length>1?(this.mouseLocs[1].x!==e.pageX||this.mouseLocs[1].y!==e.pageY)&&(this.mouseLocs.push({x:e.pageX,y:e.pageY}),this.mouseLocs.length>this.defaultSettings.maxMouseLocs&&this.mouseLocs.shift()):this.mouseLocs.push({x:e.pageX,y:e.pageY})},toggleFocusEvents:function(e){var t=e?"subscribe":"stopSubscribing";this[t]("nyt:page-key-tab nyt:page-key-up-a11y nyt:page-key-down-a11y",this.handleFocusKey),this[t]("nyt:page-key-esc-a11y nyt:page-key-left-a11y",this.handleCollapseKey),this[t]("nyt:page-key-enter nyt:page-key-right-a11y",this.handleExpandKey),this[t]("nyt:navigation-level-one-open nyt:navigation-level-two-open",this.addFocusableElements),e?(this.focusableElements=[],this.addFocusableElements(),this.$document.on("mousemove",this.detectFalsePositive)):delete this.focusableElements},addFocusableElements:function(e){var t,i;this.settings.a11yEnabled&&(e&&e.length>0?i=".active a[role=menuitem]:visible, .section-heading a.active[role=menuitem]:visible":(e=this.$el,i="a[role=menuitem]:visible, .section-heading a.active[role=menuitem]:visible"),t=e.find(i).toArray(),this.focusableElements.push({first:t[0],all:t,last:s.last(t)}),t[0].focus())},handleFocusKey:function(e){var t=s.last(this.focusableElements),i=this.getKeyDirection(e),n=document.activeElement;if(n===t.last&&"forward"===i)t.first.focus();else if(n===t.first&&"backward"===i)t.last.focus();else if("forward"===i)t.all[s.indexOf(t.all,n)+1].focus();else{if("backward"!==i)return;t.all[s.indexOf(t.all,n)-1].focus()}e.preventDefault()},handleCollapseKey:function(){var e;this.focusableElements.pop(),e=s.last(this.focusableElements),this.focusableElements.length>1?(this.resetNav(this.navLevels.TERTIARY),e.active.focus()):this.focusableElements.length>0?(this.modalClose(),e.active.focus()):this.close()},handleExpandKey:function(e){var i=t(document.activeElement),n=s.last(this.focusableElements);n.active=i,i.hasClass("expandable")&&(e.preventDefault(),i.closest(".secondary").length>0?this.activateSecondaryItem(e):this.activatePrimaryItem(e))},detectFalsePositive:s.throttle(function(e){t(e.target).is('a[role="menuitem"], li[role="presentation"')&&this.disableA11yNav()},1e3),getKeyDirection:function(e){var t="",s=this.pageManager.KEYS,i=e&&e.keyCode?e.keyCode:null;switch(i){case s.UP:case s.LEFT:t="backward";break;case s.DOWN:case s.RIGHT:case s.TAB:t="forward"}return t},enableA11Nav:function(){this.settings.a11yEnabled=!0},disableA11yNav:function(){this.settings.a11yEnabled=!1,this.toggleFocusEvents(!1),this.$document.off("mousemove",this.detectFalsePositive)}});return d}),define("shared/navigation/views/navigation-edge-adjust",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager"],function(e,t,s){var i=s.registerView("navigation").extend({el:"#navigation-edge",events:{mouseenter:"handleMouseOver",mouseleave:"handleMouseOut",click:"handleClick"},nytEvents:{"nyt:page-breakpoint":"handleBreakPoint"},initialize:function(){this.pageManager.isDomReady()?this.render():this.subscribe("nyt:page-ready",this.render)},render:function(){this.$shell=e("#shell"),this.pageManager.getCurrentBreakpoint()>=10070&&(this.setNavWidth(),this.subscribe("nyt:page-resize",this.setNavWidth))},setNavWidth:function(){var e=this.$shell.offset();this.$shell.offset()&&(this.broadcast("nyt:navigation-edge-size-change",e.left),this.$el.css("width",e.left))},handleBreakPoint:function(e){e>=10070?this.subscribe("nyt:page-resize",this.setNavWidth):(this.stopSubscribing("nyt:page-resize",this.setNavWidth),this.$el.css("width",""))},handleMouseOver:function(e){(0!==e.clientX||0!==e.clientY)&&this.broadcast("nyt:navigation-edge-mouse-enter",e)},handleMouseOut:function(e){this.broadcast("nyt:navigation-edge-mouse-leave",e)},handleClick:function(){this.broadcast("nyt:navigation-edge-click")}});return i}),define("shared/navigation/views/mobile-navigation",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/navigation/views/navigation","shared/navigation/views/navigation-edge-adjust","shared/navigation/templates","foundation/models/user-data"],function(e,t,s,i,n,a,o){var l=s.registerView("mobile-navigation").extend({el:"#mobile-navigation",hiddenEl:"#main, #ribbon, #site-index",nytEvents:{"nyt:masthead-section-click":"handleSectionClick","nyt:page-breakpoint":"handleBreakPoint"},handleUserReady:function(){this.$masthead=e("#masthead").find(".sections-button"),this.render()},render:function(){this.$el.html(a.mobileNav({userData:o,pageManager:this.pageManager}))},open:function(){this.$el.removeClass("hidden"),this.$masthead.addClass("mobile-navigation-active"),this.$el.focus(),e(this.hiddenEl).addClass("hidden"),window.scrollTo(0,0)},close:function(){this.$el.addClass("hidden"),this.$masthead.removeClass("mobile-navigation-active"),e(this.hiddenEl).removeClass("hidden")},handleSectionClick:function(){this[this.$el.is(":visible")?"close":"open"]()},handleBreakPoint:function(e){e>=120&&(new i,new n,this.close(),this.remove())}});return l}),define("shared/navigation/views/site-index-responsive",["jquery/nyt","underscore/nyt","foundation/views/base-view"],function(e,t,s){var i=s.registerView("navigation").extend({events:{"click a":"handleSiteIndexClick","click .menu-heading":"handleClick","click .menu-label":"handleClick","keyup .menu-heading":"handleKeyboard"},nytEvents:{"nyt:page-breakpoint":"handleBreakPoint"},initialize:function(){var e=this.$el.find(".column");this.$columnHeader=e.find("h3"),this.$columnContents=e.find("ul")},handleDomReady:function(){this.render()},render:function(){this.subscribe("nyt:page-resize",this.setNavWidth),this.handleBreakPoint()},handleBreakPoint:function(){var t,s,i,n;this.pageManager.getCurrentBreakpoint()>=1e3?(this.isSmallSiteIndex=!1,t="removeClass",s="removeAttr",this.$columnContents[t]("expanded")[t]("collapsed")[s]("aria-expanded","true")[s]("aria-expanded","false")):(this.isSmallSiteIndex=!0,t="addClass",s="attr",this.$columnContents[t]("collapsed")[s]("aria-expanded","true")[s]("aria-expanded","false")),this.$columnHeader[t]("toggle")[s]("role","button")[s]("tabindex","0")[s]("aria-pressed","true")[s]("aria-pressed","false"),e.each(this.$columnHeader,function(t,a){n=e(a),i=n.text(),i=i.substr(0,i.indexOf(" ")).toLowerCase(),n[s]("id",i+"-menu-heading")[s]("aria-controls",i+"-menu"),n.siblings("ul")[s]("id",i+"-menu")[s]("aria-labelled-by",i+"-menu-heading")})},handleKeyboard:function(e){(13===e.keyCode||32===e.keyCode)&&this.handleClick(e)},handleClick:function(t){var s,i,n;this.isSmallSiteIndex&&(i=e(t.target),s=i.nextAll("ul"),n=s.find("a"),s.toggleClass("collapsed"),s.toggleClass("expanded"),"false"===i.attr("aria-pressed")?(i.attr("aria-pressed","true"),s.attr("aria-expanded","true"),n.removeAttr("tabindex","-1")):(i.attr("aria-pressed","false"),s.attr("aria-expanded","false"),n.attr("tabindex","-1")))},handleSiteIndexClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"SiteIndex",region:"Footer"});s.attr("href",i)}});return i}),define("shared/navigation/instances/navigation",["jquery/nyt","foundation/views/page-manager","shared/navigation/views/navigation","shared/navigation/views/mobile-navigation","shared/navigation/views/navigation-edge-adjust","shared/navigation/views/site-index-responsive"],function(e,t,s,i,n,a){t.getCurrentBreakpoint()>=120?(new s,new n):new i,new a({el:e("#site-index")})}),define("shared/messaging/templates",["underscore/nyt"],function(_){var templates={};return templates.message=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",closeButton&&(__p+='\n<button class="button close-message">\n<i class="icon"></i>\n<span class="visually-hidden">Close alert</span>\n</button>\n'),__p+="",sub_type&&(sub_type=sub_type.replace(/([A-Z])/g,"-$1").toLowerCase(),"-"===sub_type.charAt(0)&&(sub_type=sub_type.substr(1))),__p+='<div class="message '+(null==(__t=sub_type)?"":__t)+'" data-messageId="'+(null==(__t=id)?"":__t)+'"><i class="icon"></i>',label&&(__p+='\n<span class="label">'+(null==(__t=label)?"":__t)+"</span>\n"),__p+='<span class="message-content">\n<span class="message-title">'+(null==(__t=title)?"":__t)+"</span>\n",buttons.length>0){__p+="\n";for(var i=0;i<buttons.length;i++)buttons[i].url&&(__p+='\n<a href="'+(null==(__t=buttons[i].url)?"":__t)+'" class="button message-button action-button">'+(null==(__t=buttons[i].text)?"":__t)+"</a>\n");__p+="\n"}if(__p+="\n",1===display_type_id&&start_time){var minutes,hours,formatted,date=new Date(1e3*start_time);hours=date.getHours(),minutes=date.getMinutes(),minutes=9>=minutes?"0"+minutes:minutes,ampm=hours>=12?"PM":"AM",hours=hours>12?hours-12:hours,formatted=""+hours+":"+minutes+" "+ampm,__p+='\n<span class="timestamp">\n'+(null==(__t=formatted)?"":__t)+"\n</span>\n"}__p+="\n",4===display_type_id&&(__p+="\n<a href='#' class=\"close-message\">"+(null==(__t=payload.dsm_cpy)?"":__t)+"</a>\n"),__p+="\n</span></div>"}return __p},templates.messenger=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="message-bed"></div>';return __p},templates.notificationModals=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",__p+=notification_type?'\n<div class="message comment-'+(null==(__t=notification_type)?"":__t)+'-message">\n':'\n<div class="message">\n',__p+='\n<a href="'+(null==(__t=link)?"":__t)+'">'+(null==(__t=title)?"":__t)+"\n","reply"===notification_type&&(__p+="\n"+(null==(__t=referenced_comment)?"":__t)+"\n"),__p+='\n</a>\n<span class="message-metadata">\n<i class="icon"></i>\n',created){__p+="\n";var hours,formatted;__p+="\n";var time=created.split(/[- :]/);__p+="\n";var date=new Date(time[0],time[1]-1,time[2],time[3],time[4],time[5]);__p+="\n",hours=date.getHours()>12?date.getHours()-12:date.getHours(),__p+="\n",formatted=""+hours+":"+date.getMinutes()+" "+(date.getHours()>=12?"PM":"AM")+" E.S.T.",__p+='\n<time class="timestamp" datetime="'+(null==(__t=created)?"":__t)+'">'+(null==(__t=formatted)?"":__t)+"</time>\n"}__p+="\n</span>\n</div>"}return __p},templates.notificationsModal=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="","default"===show)__p+='\n<div class="message default-message">\n<span class="message-content">Notifications related to your NYTimes activity will be collected for you here.</span>\n</div>\n';else{if(__p+="\n",__p+=notification_type?'\n<div class="message comment-'+(null==(__t=notification_type)?"":__t)+'-message">\n':'\n<div class="message">\n',__p+="\n",user_avatar&&(__p+='\n<span class="avatar"><img src="'+(null==(__t=user_avatar)?"":__t)+'" /></span>\n'),__p+='<div class="message-content">\n',__p+=link?'\n<a class="link" href="'+(null==(__t=link)?"":__t)+'">'+(null==(__t=title)?"":__t)+"</a>\n":"\n"+(null==(__t=title)?"":__t)+"\n",__p+="",("recommendation"===notification_type||"published"===notification_type)&&(__p+="\n",referenced_comment&&(__p+='\n<p class="referenced-comment">'+(null==(__t=referenced_comment)?"":__t)+"</p>\n"),__p+="\n"),__p+='\n<i class="icon"></i>\n',created){__p+="\n";
var hours,formatted;__p+="\n";var time=created.split(/[- :]/);__p+="\n";var date=new Date(time[0],time[1]-1,time[2],time[3],time[4],time[5]);__p+="\n",hours=date.getHours()>12?date.getHours()-12:date.getHours(),__p+="\n",formatted=""+hours+":"+date.getMinutes()+" "+(date.getHours()>=12?"PM":"AM")+" E.S.T.",__p+='\n<time class="timestamp" datetime="'+(null==(__t=created)?"":__t)+'">'+(null==(__t=formatted)?"":__t)+"</time>\n"}__p+="\n</div>\n</div>\n"}__p+=""}return __p},templates}),define("shared/messaging/views/message",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/messaging/templates"],function(e,t,s,i){var n=s.registerView("messaging").extend({className:"message-container hidden",events:{"click .close-message":"dismissed","mousedown .action-button":"acknowledged","mousedown .action-link":"acknowledged"},defaults:{closeButton:!0,dismissAcknowledged:!0,hiddenClass:"hidden",revealClass:"",show:function(){this.$el.removeClass(this.settings.hiddenClass).addClass(this.settings.revealClass)},hide:function(){this.$el.removeClass(this.settings.revealClass).addClass(this.settings.hiddenClass)}},initialize:function(e){this.settings=t.extend({},this.defaults,e),this.template=i[this.settings.template],this.subscribe(this,"nyt:messaging-message-expired",this.expired)},render:function(){return this.$el.html(this.template(t.extend(this.model.toJSON(),this.settings))).addClass(this.settings.hiddenClass),this.model.get("links")&&this.insertLinks(),this},replaceBetween:function(e,t,s,i){return i.substring(0,e)+s+i.substring(t)},insertLinks:function(){var e,t,s,i,n=this.$el.find(".message-title"),a=n.html(),o=this.model.get("links");o.length>1&&o.sort(function(e,t){return t.start-e.start});for(var l=0;l<o.length;l++)if(e=o[l].offset,s=o[l].count,i=decodeURI(o[l].url),e+s&&(t=e+s),i&&"null"!==i)if("undefined"!=typeof e&&"undefined"!=typeof t){if(o[l-1]&&t>o[l-1].start)break;var r=a.substring(e,t),d='<a class="action-link" href="'+i+'">'+r+"</a>";a=this.replaceBetween(e,t,d,a)}else a='<a class="action-link" href="'+i+'">'+a+"</a>";n.html(a)},reveal:function(e){e?this.settings.show.call(this):this.settings.hide.call(this)},dimensions:function(){return{width:this.$el.outerWidth(),height:this.$el.outerHeight()}},displayed:function(t){var s=this.$el.find(".message");t=t||0,s.hasClass("theme-new")&&window.setTimeout(function(){s.removeClass("theme-new").addClass("theme-read").delay(t).queue(function(){e(this).addClass("no-transition").dequeue()})},t),this.model.displayed()},showOnce:function(){this.model.showOnce()},acknowledged:function(){this.settings.dismissAcknowledged&&this.model.acknowledged(),this.local(this,"nyt:messaging-message-view-acknowledged",this)},expired:function(){this.model.expired(),this.local(this,"nyt:messaging-message-view-expired",this)},dismissed:function(e){this.model.dismissed(),this.local(this,"nyt:messaging-message-view-dismissed",this),e.preventDefault()}});return n}),define("shared/messaging/collections/websockets-mixin",["foundation/lib/sockjs"],function(e){var t={reconnectAttempt:0,initializeWebSockets:function(t,s,i){var n=this,a={debug:!0};e&&this.url&&(this.webSocket=new e(this.url,null,a),this.webSocket.onopen=function(){n.local(n,"nyt:messaging-websocket-connected"),n.onOpen(function(){n.settings.webSocketsLogin&&n.settings.webSocketsLogin(n)})},this.webSocket.onmessage=function(e){n.local(n,"nyt:messaging-websocket-message-received"),n.reconnectAttempt=0,n.receive(e,i)},this.webSocket.onclose=function(e){n.local(n,"nyt:messaging-websocket-disconnected"),n.reconnect(e)})},onOpen:function(e){e()},receive:function(e,t){var s=this.parse(e),i=this;s&&(i.add(s),t.success&&t.success(i,e))},publish:function(t){this.webSocket&&this.webSocket.readyState===e.OPEN&&"undefined"!=typeof e&&null!==e&&this.webSocket.send(JSON.stringify(t))},reconnect:function(e){var t=e.wasClean,s=this;t?this.initWebSockets():(this.reconnectAttempt+=1,this.reconnectAttempt>5?this.switchToHTTP():window.setTimeout(function(){s.initWebSockets()},3e3))}};return t}),define("shared/messaging/models/message",["backbone/nyt","foundation/models/base-model","foundation/models/page-storage"],function(e,t,s){var i=t.extend({defaults:{display_type_id:"1",id:"",title:"",status:"new",sub_type:"",label:"",pub_date:"",start_time:"",end_time:"",links:[],buttons:[],payload:{}},showOnce:function(){this.saveToLocalStorage()},displayed:function(){this.set("status","displayed")},acknowledged:function(){this.set("status","acknowledged"),this.saveToLocalStorage()},expired:function(){this.set("status","expired"),this.saveToLocalStorage()},dismissed:function(){this.set("status","dismissed"),this.saveToLocalStorage()},saveToLocalStorage:function(){var e=this.get("id"),t=this.get("version"),i=(new Date).getTime(),n=s.get("messaging"),a=n?n+","+e:e;t&&(a=a+"-"+t+"-"+i),s.set("messaging",a)}});return i}),define("shared/messaging/collections/messages",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/collections/base-collection","shared/messaging/collections/websockets-mixin","shared/messaging/models/message","foundation/hosts","foundation/cookies","foundation/models/page-storage"],function(e,t,s,i,n,a,o,l,r){var d=i.extend(t.extend({},n,{model:a,url:o.msg+"/svc/message/v1/list/global.json",pageStorageKey:"messaging",defaultSettings:{webSockets:!0,webSocketsInfoUrl:o.msgSocket+"/endpoints.json?jsoncallback=?",webSocketsLogin:function(e){var t=l.readCookie("NYT-S")||"";e.publish({action:"login",client_app:"hermes.push",cookies:{"nyt-s":t}})},longPoll:!1,fauxLongPoll:!1,interval:10},initialize:function(e){var s=/nytimes.com((\/\?)|(\/?$)|(\?))/i;window.location.href.match(s)&&(this.isHomepage=!0),this.cleanLocalStorage(),this.settings=t.extend({},this.defaultSettings,e),t.bindAll(this,"fetch","fetchSuccess","handleSave","stopSaving"),this.received={},this.pageManager.isDomReady()?this.initConnection():(this.subscribe(this.pageManager,"nyt:page-ready",this.initConnection),this.subscribe(this,"nyt:messaging-websocket-connected",this.handleSave),this.subscribe(this,"nyt:messaging-websocket-disconnected",this.stopSaving))},initConnection:function(){this.isHomepage?(this.settings.fauxLongPoll=!0,this.settings.webSockets=!1,this.makeHTTPRequest()):this.initWebSockets()},initWebSockets:function(){var t=this;e.ajax({dataType:"json",url:this.settings.webSocketsInfoUrl,success:function(e){e.http_sockjs_url&&(t.url=e.http_sockjs_url,t.fetch({success:t.fetchSuccess}))},error:function(){t.switchToHTTP()}})},makeHTTPRequest:function(){var e=this;this.url=o.msg+"/svc/message/v1/list/global.json",this.fetch({success:function(t,s){e.fetchSuccess(t,s)},error:function(){}})},switchToHTTP:function(){this.settings.fauxLongPoll=!0,this.settings.webSockets=!1,this.makeHTTPRequest()},fetch:function(e){return this.settings.webSockets?(e=e?t.clone(e):{},this.sync("read",this,e)):s.Collection.prototype.fetch.call(this,e)},sync:function(e,t,i){return this.settings.webSockets?(this.initializeWebSockets(e,t,i),void 0):this.settings.longPoll?(i.timeout=2e3,s.sync(e,t,i)):(i.cache=!1,s.sync(e,t,i))},parse:function(e){var t;if(this.settings.webSockets){if(t=e.data,t&&t.body)return"start"!==t.type&&"finish"!==t.type?JSON.parse(t.body):!1}else if(e.results)return e.results.messages},fetchSuccess:function(e,t){var s,i,n,a,o,l,r,d={},c=e||this;if(t){for(s=0,i=c.length;i>s;s+=1)n=c.at(s),a=n.get("id"),o=n.get("title"),l=this.categorizeMessage(n),d[l]=d[l]||[],a&&o&&(this.expired(n)||this.inactive(n)||this.isInLocalStorage(n)||this.exists(a)||this.titleExists(o)||(this.received[a]=o,d[l].push(this.get(n.id))));for(l in d)c.trigger(l,d[l]);r=t.count,r&&c.trigger("nyt:messaging-count-received",r)}this.settings.fauxLongPoll&&window.setTimeout(function(){c.makeHTTPRequest()},1e3*c.settings.interval)},categorizeMessage:function(e){var t,s=e.get("display_type_id");switch(s){case 1:e.get("label")||e.set("label","Breaking News"),t="nyt:messaging-breaking-news-received";break;case 2:e.get("label")||e.set("label","Account Alert"),t="nyt:messaging-account-alert-received";break;case 3:e.get("label")||e.set("label","Live Video"),t="nyt:messaging-video-received";break;case 4:t="nyt:messaging-velcro-received";break;case 5:t="nyt:messaging-notification-received";break;default:t="nyt:messaging-message-received"}return t},expired:function(e){var t,s=e.get("end_time"),i=(new Date).getTime();return s?(t=new Date(1e3*s).getTime(),i>t?!0:!1):void 0},exists:function(e){return e in this.received},titleExists:function(s){var i=t.values(this.received);return e.inArray(s,i)>-1},inactive:function(e){return"dismissed"===e.get("status")||"expired"===e.get("status")||"acknowledged"===e.get("status")},isInLocalStorage:function(s){var i=[],n=[],a=r.get(this.pageStorageKey),o=s.get("id").toString();return a?(i=a.split(","),n=t.map(i,function(e){return e.split("-")[0]}),e.inArray(o,n)>-1):!1},cleanLocalStorage:function(){var e,t,s,i,n,a,o,l=r.get(this.pageStorageKey);if(l)for(e=l.split(","),s=0;s<e.length;s++)t=e[s],i=t.split("-")[2],n=(new Date).getTime(),i&&(a=(n-i)/1e3,o=Math.floor(a/86400),o>7&&this.deleteInLocalStorage(t))},deleteInLocalStorage:function(e){var t=r.get(this.pageStorageKey),s=new RegExp(e+",?"),i=t.replace(s,"");r.set(this.pageStorageKey,i)},handleSave:function(){this.listenTo(this,"change:status",function(e){this.saveMessage(e)})},stopSaving:function(){this.stopListening(this,"change:status")},saveMessage:function(e){var t=e.get("status"),s=e.get("id");this.settings.webSockets&&this.publish({action:"send",client_app:"hermes.push",message:{status:t,messageId:s}})}}));return d}),define("shared/messaging/instances/messages",["shared/messaging/collections/messages"],function(e){return new e}),define("shared/messaging/views/messenger-mixin",["jquery/nyt","underscore/nyt","shared/messaging/views/message","shared/messaging/instances/messages","shared/messaging/templates"],function(e,t,s,i,n){var a={template:n.messenger,mixinSettings:{id:null,notifyWhen:null,messageType:null,parent:null,template:"message",newestFirst:!0,closeButton:!0,expiration:!1,animationSpeed:200,expirationAfterPause:null,fadeOutDelay:1500,dismissAcknowledged:!0,trackingVersion:""},events:{"click .action-link":"trackLinkClicks","click .action-button":"trackLinkClicks"},initialize:function(e){this.options=t.extend({},this.mixinSettings,this.defaultSettings,e),this.subscribe(this,"nyt:messaging-message-rendered",this.afterMessageReceived),this.subscribe(this,"nyt:messaging-message-removed",this.afterMessageRemoved),this.subscribe(this,"nyt:messaging-message-"+this.options.id+"-displayed nyt:messaging-message-cleared",this.addLastMessageClass),this.subscribe(this,"nyt:messaging-message-"+this.options.id+"-displayed",this.trackImpressions),this.delegateEvents(),this.collection=i,this.active={messages:{}},this.notActive={messages:{}},this.received={messages:{}},this.pageManager.isDomReady()?this.render():this.subscribe(this.pageManager,"nyt:page-ready",this.render),this.trackingBaseData={module:"Notification",version:this.options.trackingVersion,region:"FixedTop"},this.local(this,"nyt:messaging-messenger-initialized")},render:function(){return this.$parent=this.options.parent?this.options.parent():this.$body,this.rendered||(this.$el.hide().addClass(this.options.id).append(this.template(this.options)),this.$parent.prepend(this.$el),this.rendered=!0,this.local(this,"nyt:messaging-messenger-rendered"),this.prepareView(),this.subscribe(this.collection,this.options.notifyWhen,this.notify)),this},notify:function(s){var i,n,a=this,o=[];t.each(s||[],function(e){n=e.get("id"),n&&o.push(e)}),i=o.length>0?function(){a.createMessageViews(o)}:e.noop,this.pageManager.isDomReady()?i():this.subscribe(this.pageManager,"nyt:page-ready",t.debounce(i,0))},createMessageViews:function(e){return e&&t.each(e||[],function(e){var t;t=new s({model:e,template:this.options.template,closeButton:this.options.closeButton,dismissAcknowledged:this.options.dismissAcknowledged}),this.subscribe(t,"nyt:messaging-message-view-expired",this.removeMessage),this.subscribe(t,"nyt:messaging-message-view-dismissed",this.removeMessage),this.subscribe(t,"nyt:messaging-message-view-dismissed",this.trackDismissal),this.addMessage(t)},this),this},addMessage:function(e){if(e){var t,s=this.options.newestFirst?"prepend":"append",i=e.model.get("id");this.received.messages[i]=e,this.active.messages[i]=e,t=this.countMessages(),this.$(".message-bed")[s](e.render().$el),e.$el.data("messageId",i),this.local(this,"nyt:messaging-message-rendered",e,t)}},removeMessage:function(e){var t,s;e&&(t=e.model.get("id"),this.notActive.messages[t]=e,this.active.messages[t]&&delete this.active.messages[t],s=this.countMessages(),this.local(this,"nyt:messaging-message-removed",e,s))},addLastMessageClass:function(){this.$(".message-container").removeClass("last-message-container").last().addClass("last-message-container")},dimensions:function(){return{width:this.$el.find(".message-bed").outerWidth(!0),height:this.$el.find(".message-bed").outerHeight(!0)}},countMessages:function(){return t.size(this.active.messages)},trackImpressions:function(e){var t,s;e=e||"",t=this.received.messages[e],s=this.getcontentCollection(t)||"",this.trackingTriggerImpression("messaging-impression",{action:"Impression",contentCollection:s,eventName:"Impression",contentID:e})},trackDismissal:function(e){var t=e.model.get("id"),s=this.getcontentCollection(e);this.trackingTrigger("messaging-dismissal",{action:"Click",contentCollection:s,eventName:"DismissNotification",contentID:t})},trackLinkClicks:function(t){var s=e(t.currentTarget),i=s.parents(".message-container").data("messageId"),n=this.received.messages[i],a=this.getcontentCollection(n),o=this.trackingAppendParams(s.attr("href"),{action:"Click",contentCollection:a,contentID:i});s.attr("href",o)},getcontentCollection:function(e){return e.model.get("sub_type")?e.model.get("sub_type"):""}};return a}),define("shared/messaging/views/move-furniture-mixin",["jquery/nyt","underscore/nyt"],function(e){var t={moveFurniture:function(t,s,i){var n,a,o,l=this,r=this.options.animationSpeed||200;"add"===s?n="+="+t:"subtract"===s&&(n="-="+t),a=function(e){e.animate({marginTop:n},r)},o=function(t){t.promise().done(function(){e(this).css({marginTop:n})})},i?(this.$el.promise().done(function(){e(this).css("height",n),l.broadcast("nyt:messaging-"+l.options.messageType+"-after")}),this.messagesHeight=this.dimensions().height,this.broadcast("nyt:messaging-"+this.options.messageType+"-move-furniture",o,n,this)):(this.$el.animate({height:n},r,function(){l.messagesHeight=l.dimensions().height,l.broadcast("nyt:messaging-"+l.options.messageType+"-after")}),this.broadcast("nyt:messaging-"+this.options.messageType+"-move-furniture",a,n,this))}};return t}),define("shared/messaging/views/critical-alerts",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/messaging/views/messenger-mixin","shared/messaging/views/move-furniture-mixin","shared/messaging/templates"],function(e,t,s,i,n){var a=s.registerView("messaging").extend(t.extend({},n,i,{defaultSettings:{messageType:"critical-alerts",parent:function(){return 0===e("#critical-alerts").length&&e("body").prepend('<div id="critical-alerts"></div>'),e("#critical-alerts")}},prepareView:function(){this.options.id;this.messagesHeight=0,this.$el.addClass("alerts"),this.$el.parent("#critical-alerts").addClass("critical-alerts messenger"),this.$el.css("height","0")},afterMessageReceived:function(e,t){var s,i=0;e&&t>0&&(this.broadcast("nyt:messaging-message-"+this.options.id+"-received",e,this),1===t&&(i+=this.openMessenger()),e.reveal(!0),e.displayed(),i+=e.dimensions().height,this.moveFurniture(i,"add"),s=e.model.get("id"),this.local(this,"nyt:messaging-message-"+this.options.id+"-displayed",s),this.createMessageClone(e),this.alignMessages(),this.options.expiration&&this.startTimer(e))},startTimer:function(e){var t;window.setTimeout(function(){t=e.model.get("status"),t&&"dismissed"!==t&&"expired"!==t&&e.trigger("nyt:messaging-message-expired")},60*this.options.expiration*1e3)},openMessenger:function(){var e;return this.$el.show(),this.$el.find(".message-bed").show(),e=this.dimensions().height,this.subscribe(this.pageManager,"nyt:page-resize",this.handleWindowResize),this.broadcast("nyt:messaging-messenger-"+this.options.id+"-opened",this),e},afterMessageRemoved:function(e,t){var s=0;e&&null!==t&&(s+=e.dimensions().height,e.$el.hide(),this.local(this,"nyt:messaging-message-cleared"),0===t&&(s+=this.closeMessenger()),this.broadcast("nyt:messaging-message-"+this.options.id+"-closed",e,this),this.moveFurniture(s,"subtract",!0))},closeMessenger:function(){var t=this.dimensions().height,s=this;return this.$el.hide(),this.$el.find(".message-bed").hide(),this.stopListening(this.pageManager,"nyt:page-resize"),this.broadcast("nyt:messaging-messenger-"+this.options.id+"-closed",this),this.$el.promise().done(function(){e(this).siblings(".alerts").is(":hidden")&&s.broadcast("nyt:messaging-message-"+s.options.messageType+"-closed",s)}),t},createMessageClone:function(e){e.$el.find(".message").clone().addClass("hidden-message").wrapInner('<div class="message-wrap" />').appendTo(e.$el)},handleWindowResize:function(){var e,t,s,i=this;this.$el.promise().done(function(){t=i.dimensions().height,s=i.messagesHeight,t>s?(e=t-s,i.moveFurniture(e,"add",!0),i.messagesHeight=t):s>t&&(e=s-t,i.moveFurniture(e,"subtract",!0),i.messagesHeight=t),i.alignMessages()})},maxMessageWidth:function(){var e=this.$(".message-container").width();this.$(".message:not(.hidden-message)").css({"max-width":e+"px"})},alignMessages:function(){var e=0,s=this.active.messages;t.size(s)>0&&(t.each(s,function(t){var s=t.$el.find(".hidden-message .message-wrap").outerWidth();s>e&&(e=s)}),this.$el.find(".message:not(.hidden-message)").css({width:e+2+"px"}),this.maxMessageWidth())}}));return a}),define("shared/messaging/views/suggestions",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/messaging/views/messenger-mixin","shared/messaging/views/move-furniture-mixin","shared/messaging/templates"],function(e,t,s,i,n){var a=s.registerView("messaging").extend(t.extend({},n,i,{nytEvents:{"nyt:masthead-storytheme":"toggleTheme","nyt:masthead-contenttheme":"toggleTheme","nyt:messaging-message-breaking-news-alerts-received":"hideMessenger","nyt:messaging-message-account-alerts-received":"hideMessenger"},defaultSettings:{messageType:"suggestions",closeButton:!1,trackingVersion:"Velcro"},prepareView:function(){this.messagePresent=!1,this.stayHidden=!1,this.$el.addClass("messenger"),this.$el.css("height","0")},afterMessageReceived:function(t){var s,i,n=e("#account-alerts"),a=e("#breaking-news-alerts"),o=e("#masthead");t&&this.$el.is(":hidden")&&n.is(":hidden")&&a.is(":hidden")&&(this.stayHidden||this.messagePresent||(t.reveal(!0),t.displayed(),t.showOnce(),this.messagePresent=!0,o.hasClass("theme-in-story")||(this.openMessenger(),s=this.dimensions().height,this.moveFurniture(s,"add"),i=t.model.get("id"),this.local(this,"nyt:messaging-message-"+this.options.id+"-displayed",i))))},openMessenger:function(){this.$el.show(),this.broadcast("nyt:messaging-messenger-"+this.options.id+"-opened",this)},afterMessageRemoved:function(e){var t=this.dimensions().height;e&&(e.$el.hide(),this.moveFurniture(t,"subtract",!0),this.broadcast("nyt:messaging-message-"+this.options.id+"-closed",e,this),this.closeMessenger())},closeMessenger:function(){this.$el.hide(),this.broadcast("nyt:messaging-messenger-"+this.options.id+"-closed",this)},hideMessenger:function(){var e=this.dimensions().height;this.$el.is(":visible")&&(this.$el.hide(),this.moveFurniture(e,"subtract",!0)),this.broadcast("nyt:messaging-message-"+this.options.id+"-hidden",this),this.stayHidden=!0},showMessenger:function(){var e=this.dimensions().height;this.moveFurniture(e,"add"),this.broadcast("nyt:messaging-message-"+this.options.id+"-shown",this),this.$el.show()},toggleTheme:function(t){var s,i=e("#account-alerts"),n=e("#breaking-news-alerts"),a=t?"hide":"show";"hide"===a&&this.$el.is(":visible")?(s=this.dimensions().height,this.moveFurniture(s,"subtract",!0),this.$el.addClass("theme-changed"),this.$el.hide()):"show"===a&&this.$el.is(":hidden")&&i.is(":hidden")&&!this.stayHidden&&this.messagePresent&&i.is(":hidden")&&n.is(":hidden")&&(this.$el.show(),s=this.dimensions().height,this.moveFurniture(s,"add",!0),this.$el.removeClass("theme-changed")),this.broadcast("nyt:messaging-message"+this.options.id+a,s,this)}}));return a}),define("shared/messaging/views/announcements",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/messaging/views/messenger-mixin","shared/messaging/templates"],function(e,t,s,i){var n=s.registerView("messaging").extend(t.extend({},i,{nytEvents:{"nyt:page-resize":"adjustWidth"},defaultSettings:{messageType:"announcements",parent:function(){return e("#masthead").find(".container")},animationSpeed:400,expiration:30,expirationAfterPause:3,trackingVersion:"LiveVideo"},prepareView:function(){var e=this,t=1e3*this.options.expirationAfterPause;this.messagePresent=!1,this.timer=null,this.currentMessageId=null,this.widthDiff=45,this.$el.addClass("messenger"),this.adjustWidth(),this.$el.on("mouseenter",function(){e.clearTimer()}),this.$el.on("mouseleave",function(){e.startTimer(t)})},afterMessageReceived:function(e){var t=e.model.get("id"),s=this,i=1e3*this.options.expiration;e&&(this.messagePresent?window.setTimeout(function(){s.afterMessageReceived(e)},i):(e.reveal(!0),e.displayed(),this.local(this,"nyt:messaging-message-"+this.options.id+"-displayed",t),this.messagePresent=!0,this.openMessenger(),this.currentMessageId=t,this.startTimer(i)))},startTimer:function(e){var t=this.currentMessageId,s=this.active.messages[t],i=function(){s&&s.trigger("nyt:messaging-message-expired")};e=e||5e3,this.timer=window.setTimeout(i,e)},clearTimer:function(){window.clearTimeout(this.timer)},openMessenger:function(){var e=this.options.animationSpeed||500;this.$el.stop(!0).show().animate({top:0},e),this.broadcast("nyt:messaging-messenger-"+this.options.id+"-opened",this)},afterMessageRemoved:function(e){e&&this.closeMessenger(e)},closeMessenger:function(t){var s=this.dimensions().height,i=this.options.animationSpeed||500,n=this;t&&this.$el.stop(!0).animate({top:"-"+s},i,function(){e(this).hide(),t.$el.hide(),n.messagePresent=!1,n.broadcast("nyt:messaging-messenger-"+n.options.id+"-closed",n)})},adjustWidth:function(){var t,s=e("#masthead"),i=s.width(),n=this.widthDiff,a=this.pageManager.getCurrentBreakpoint(),o=0;a>1020?(10060>=a&&(o=parseInt(s.css("margin-left"),10)),t=i-(2*n+o),this.$el.css("width",t+"px"),this.$el.css("left",n+"px")):(this.$el.css("left","0px"),this.$el.css("width","100%"))}}));return n}),define("shared/messaging/instances/messaging",["jquery/nyt","foundation/views/page-manager","shared/messaging/views/critical-alerts","shared/messaging/views/suggestions","shared/messaging/views/announcements"],function(e,t,s,i,n){!t.$html.hasClass("lt-ie9")&&!t.$html.hasClass("template-minimal")&&t.getCurrentBreakpoint()>=120&&(new i({id:"suggestions",notifyWhen:"nyt:messaging-velcro-received"}),new s({id:"breaking-news-alerts",notifyWhen:"nyt:messaging-breaking-news-received",expiration:20,dismissAcknowledged:!1,trackingVersion:"BreakingNews"}),new s({id:"account-alerts",notifyWhen:"nyt:messaging-account-alert-received",expiration:10,trackingVersion:"UserAccounts"}),new n({id:"announcements",notifyWhen:"nyt:messaging-video-received"}))}),define("shared/searchform/views/search-form",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/searchform/helpers/search-form-mixin"],function(e,t,s,i){var n=s.extend(t.extend({},i,{events:{"keyup .search-input":"handleKeyUp","keydown .search-input":"handleKeyDown","click .submit-button":"submitSearch","click .clear-button":"handleClearButton"},afterInitialize:function(){this.$shell.on("click",this.handlePageClicks)}}));return n}),define("shared/searchform/instances/search-form",["jquery/nyt","foundation/views/page-manager","shared/searchform/views/search-form"],function(e,t,s){t.getMeta("errorpage")&&new s({el:e(".error-page .search-form-control")})}),define("shared/whatsnext/templates",["underscore/nyt"],function(_){var templates={};return templates.loader=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="loader-container">\n<div class="loader"><span class="visually-hidden">Loading...</span></div>\n</div>';return __p},templates.section=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<section class="'+(null==(__t=className)?"":__t)+'"></section>';return __p},templates.topStories=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<header>\n<h2 class="section-heading"><a href="'+(null==(__t=sectionUrl)?"":__t)+'">'+(null==(__t=headingLabel)?"":__t)+'</a></h2>\n<p class="user-action"><a href="'+(null==(__t=sectionUrl)?"":__t)+'">'+(null==(__t=sectionLinkLabel)?"":__t)+' &raquo;</a></p>\n</header>\n<ul class="menu layout-horizontal theme-story">\n',_.each(collection,function(e,t){__p+="\n<li"+(null==(__t=2===t?' class="last-item"':"")?"":__t)+'>\n<a href="'+(null==(__t=e.get("link"))?"":__t)+'" class="story-link">\n',e.getCrop("mediumThreeByTwo210")?(__p+='\n<article class="story theme-summary">\n<div class="wide-thumb">\n<img src="'+(null==(__t=e.getCrop("mediumThreeByTwo210").url)?"":__t)+'" />\n</div>\n',__p+=e.get("kicker")?'\n<h3 class="kicker">'+(null==(__t=e.get("kicker"))?"":__t)+'</h3>\n<h2 class="story-heading">'+(null==(__t=e.get("headline"))?"":__t)+"</h2>\n":'\n<h2 class="story-heading">'+(null==(__t=e.get("headline"))?"":__t)+"</h2>\n",__p+="\n</article>\n"):(__p+='\n<article class="story theme-summary no-thumb">\n',e.get("kicker")&&(__p+='\n<h3 class="kicker">'+(null==(__t=e.get("kicker"))?"":__t)+"</h3>\n"),__p+='<h2 class="story-heading">'+(null==(__t=e.get("headline"))?"":__t)+"</h2>",e.get("description")&&(__p+='\n<p class="summary">'+(null==(__t=e.get("description"))?"":__t)+"</p>\n"),__p+="\n</article>\n"),__p+="\n</a>\n</li>\n"}),__p+="\n</ul>";return __p},templates}),define("shared/whatsnext/views/top-stories",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/whatsnext/templates"],function(e,t,s,i){var n=s.extend({template:i,initialize:function(e){this.settings=t.extend({},e),this.settings.items||(this.settings.items=3),this.collection.length>1?this.render():(this.$el.html(this.template.loader()),this.subscribeOnce(this.collection,"sync",this.render))},getNeatCollection:function(){var e=this.pageManager.getMeta("articleid"),t=this.pageManager.getCanonical();return this.collection.chain().uniq(!1,function(e){var t=e.attributes,s=t.data_id;return s?s:t.link}).reject(function(s){var i=s.attributes;return i.data_id&&i.data_id===e?!0:-1!==i.link.indexOf(t)?!0:!1}).first(this.settings.items).value()},render:function(){var t=this,s=this.template.topStories({headingLabel:this.settings.headingLabel,sectionLinkLabel:this.settings.sectionLinkLabel,sectionUrl:this.settings.sectionUrl||this.collection.getUrl(),collection:this.getNeatCollection()});this.$el.html(s),this.$el.css("opacity",0),this.$el.animate({opacity:1},400),this.$el.find(".whats-next h2").each(function(){var s=e(this).height();s>=81&&t.truncateText(e(this),80)}),this.$el.find(".summary").each(function(){t.truncateText(e(this),72)})}});return n}),define("shared/data/helpers/collection-mixin",["jquery/nyt","underscore/nyt"],function(){var e={hasFetched:!1,getNext:function(e,t){var s=e.indexOf(t),i=s===e.length?0:s+1;return e.at(i)},loadData:function(){return 0!==this.length||this.hasFetched||(this.hasFetched=!0,this.fetch()),this},getIdentifier:function(){return"rref="+this.sectionId},getName:function(){return this.sectionName},getUrl:function(){return this.sectionUrl}};return e}),define("shared/data/collections/most-popular",["backbone/nyt","foundation/collections/base-collection","shared/data/models/article","foundation/hosts","underscore/nyt","shared/data/helpers/collection-mixin"],function(e,t,s,i,n,a){var o=t.extend(n.extend({},a,{model:s,apis:{mostviewed:{url:i.s1+"/du/mostpopular/viewed/all_1.jsonp?v1",callback:"jsonCallbackViewed"},mostemailed:{url:i.s1+"/du/mostpopular/emailed/all_1.jsonp?v1",callback:"jsonCallbackEmailed"}},initialize:function(e,t){this.url=this.apis[t.type].url,this.callback=this.apis[t.type].callback},sync:function(t,s,i){return i.dataType="jsonp",i.jsonpCallback=this.callback,i.jsonp="callback",i.cache=!0,e.sync(t,s,i)},parse:function(e){var t=this,s=n.map(e.results,function(e){var s=[];return e.id&&(e.data_id=e.id,delete e.id),e.asset_id&&delete e.asset_id,""===e.media?delete e.media:s=e.media[0]["media-metadata"]||[],e.promotional_media={image:{image_crops:{thumbStandard:t.getCrop(s,"Standard Thumbnail"),mediumThreeByTwo210:t.getCrop(s,"mediumThreeByTwo210")}}},e.description=e.abstract,e.link=e.url,e.kicker=e.column,e.headline=e.title,e.authors=[e.byline.replace("By ","").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})],e.pubDate=e.published_date,e});return s},getCrop:function(e,t){var s,i;for(s=0,i=e.length;i>s;s+=1)if(e[s].format===t)return e[s]},getIdentifier:function(){return"src=me"}}));return o}),define("shared/data/instances/most-emailed",["jquery/nyt","foundation/views/page-manager","foundation/hosts","shared/data/collections/most-popular"],function(e,t,s,i){return new i([],{type:"mostemailed"})}),define("shared/data/collections/recommendations",["backbone/nyt","foundation/collections/base-collection","shared/data/models/article","foundation/hosts","underscore/nyt","shared/data/helpers/collection-mixin"],function(e,t,s,i,n,a){var o=t.extend(n.extend({},a,{model:s,url:i.du+"/svc/recommendations/v3/personalized.jsonp",sync:function(t,s,i){return i.dataType="jsonp",i.jsonpCallback="jsonRecommended",i.jsonp="callback",i.cache=!0,i.data={access_key:"776ACB1E-6C7F-4702-9E18-CF329376F5A3"},e.sync(t,s,i)},parse:function(e){var t=this,s=n.map(e.suggestions,function(e){var s=e.thumbs||{};return e.promotional_media={image:{image_crops:{thumbStandard:e.thumbnail,mediumThreeByTwo210:t.getCrop(s,"mediumThreeByTwo210")}}},e.kicker&&"Video"===e.item_type?e.kicker="Video | "+e.kicker:"Video"===e.item_type&&(e.kicker="Video"),e.authors=e.byline?[e.byline.replace("By ","").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})]:"",e.description=e.abstract,e.link=e.url,e.headline=e.title,e.pubDate=e.published_date,e});return this.num_articles=e.num_articles,this.uid=e.uid,this.user_displayname=e.user_displayname,this.user_pic_url=e.user_pic_url,s},getCount:function(){return this.num_articles||0},getUserId:function(){return this.uid||0},getUserDisplayName:function(){return this.user_displayname||null},getUserPictureUrl:function(){return this.user_pic_url||null},getCrop:function(e,t){var s,i;for(s=0,i=e.length;i>s;s+=1)if(e[s].type===t)return e[s].url=e[s].content,e[s]},getIdentifier:function(){return"src=recg"}}));return o}),define("shared/data/instances/recommendations",["jquery/nyt","foundation/views/page-manager","shared/data/collections/recommendations"],function(e,t,s){return new s}),define("shared/data/collections/context",["backbone/nyt","foundation/collections/base-collection","shared/data/models/article","foundation/hosts","underscore/nyt","shared/data/helpers/collection-mixin"],function(e,t,s,i,n,a){var o=t.extend(n.extend({},a,{model:s,sync:function(t,s,i){var n,a=this.pageManager.getMeta("article:collection");return a?(i.url=a,i.dataType="jsonp",n=i.url.match(/sectionfronts\/(.+)\/index/)||["","homepage"],i.jsonpCallback="jsonFeedCallback_"+n[1].replace(/\/|\-/g,"_"),this.sectionId=n[1],e.sync(t,s,i)):void 0},parse:function(e){return this.sectionName=e.title.replace("NYT > ",""),this.sectionUrl=e.link,e.items}}));return o}),define("shared/data/instances/context",["jquery/nyt","foundation/views/page-manager","shared/data/collections/context"],function(e,t,s){return new s}),define("shared/data/collections/top-news",["underscore/nyt","backbone/nyt","foundation/collections/base-collection","shared/data/models/article","foundation/hosts","shared/data/helpers/collection-mixin"],function(e,t,s,i,n,a){var o=s.extend(e.extend({},a,{model:i,initialize:function(){this.url=n.json+("us"===this.pageManager.getEdition()?"/services/json/sectionfronts/index.jsonp":"/services/json/sectionfronts/international/index.jsonp")
},sync:function(e,s,i){return i.dataType="jsonp",i.jsonpCallback="us"===this.pageManager.getEdition()?"jsonFeedCallback_homepage":"jsonFeedCallback_international",t.sync(e,s,i)},parse:function(e){return e.items},getIdentifier:function(){return"rref=homepage"}}));return o}),define("shared/data/instances/top-news",["jquery/nyt","foundation/views/page-manager","shared/data/collections/top-news"],function(e,t,s){return new s}),define("shared/whatsnext/views/helpers/top-ranked-factory",["foundation/views/page-manager","foundation/hosts","shared/data/instances/most-emailed","shared/data/instances/recommendations","shared/data/instances/context","shared/data/instances/top-news"],function(e,t,s,i,n,a){var o=e.getMeta("article:section"),l=o&&0===o.indexOf("The "),r=t.www,d={context:{el:".section-news",headingLabel:"More in "+o,sectionLinkLabel:"Go to "+(l?"":"the ")+o+" Section",collection:n},"top-news":{el:".top-news",headingLabel:"Top News",sectionLinkLabel:"Go to the Home Page",sectionUrl:r,collection:a},"most-emailed":{el:".most-emailed",headingLabel:"Most Emailed",sectionLinkLabel:"Go to the Most Emailed Section",sectionUrl:r+"/most-popular-emailed",collection:s},recommendations:{el:".recommendations",headingLabel:"Recommended for You",sectionLinkLabel:"Go to All Recommendations",sectionUrl:r+"/recommendations",collection:i}},c={createTemplate:function(e){return d[e]}};return c}),define("shared/whatsnext/views/whats-next",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/whatsnext/views/top-stories","shared/whatsnext/views/helpers/top-ranked-factory","shared/whatsnext/templates","foundation/models/user-data"],function(e,t,s,i,n,a,o){var l=s.registerView("whats-next").extend({el:"#whats-next",defaultSettings:{sections:"context,top-news"},events:{"click .section-news a":"handleMoreClick","click .top-news a":"handleTopNewsClick","click .recommendations a":"handleRecommendationsClick"},initialize:function(e){t.bindAll(this,"render"),this.settings=t.extend({},this.defaultSettings,e),this.trackingBaseData={action:"click",contentCollection:this.pageManager.getMeta("article:section"),region:"Footer"}},handleDomReady:function(){this.pageManager.isComponentVisible(this.$el)?o.ready(this.render):this.subscribe("nyt:page-scroll",this.handleScrollCheck)},handleScrollCheck:function(){this.pageManager.isComponentVisible(this.$el)&&o.ready(this.render)},handleMoreClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"MoreInSection"});s.attr("href",i)},handleTopNewsClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"TopNews"});s.attr("href",i)},handleRecommendationsClick:function(t){var s=e(t.currentTarget),i=this.trackingAppendParams(s.attr("href"),{module:"Recommendation",src:"recg"});s.attr("href",i)},render:function(){var e,t,s,l=o.isLoggedIn()?this.settings.registered:this.settings.anonymous;for(this.stopSubscribing("nyt:page-scroll",this.handleScrollCheck),l=l.split(","),e=0,t=l.length;t>e;e+=1)s=n.createTemplate(l[e]),s.items=3,"context"===l[e]&&"1"===this.isUserVariant("whatsNext")&&(s.items=6),s.collection.loadData(),this.$el.append(a.section({className:s.el.replace(".","")})),new i(s)}});return l}),define("shared/whatsnext/instances/whats-next",["foundation/views/page-manager","shared/whatsnext/views/whats-next"],function(e,t){var s,i;e.getMeta("errorpage")?(s="most-emailed,top-news",i="most-emailed,top-news"):e.getMeta("article:section")?(s="context,recommendations",i="context,top-news"):(s="top-news,recommendations",i="top-news"),new t({registered:s,anonymous:i})}),define("shared/recommendations/templates",["underscore/nyt"],function(_){var templates={};return templates.mostPopular=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",collection.length?(__p+="<ol>",_.each(collection.slice(0,10),function(e){__p+='<li>\n<a class="story-link" href="'+(null==(__t=e.get("link"))?"":__t)+'">\n<article class="story">\n',e.getCrop("thumbStandard")&&(__p+='\n<div class="small-thumb">\n<img src="'+(null==(__t=e.getCrop("thumbStandard").url)?"":__t)+'" />\n</div>\n'),__p+="\n",e.get("kicker")&&(__p+='\n<h3 class="kicker">'+(null==(__t=e.get("kicker"))?"":__t)+"</h3>\n"),__p+='\n<h2 class="story-heading">\n'+(null==(__t=e.get("headline"))?"":__t)+"\n</h2>\n</article>\n</a>\n</li>"}),__p+="</ol>"):__p+='<p class="error-message">This article list is not currently available. Please try again later.</p>',__p+='<footer class="recommendations-footer">\n<p class="user-action"><a href="http://www.nytimes.com/gst/mostpopular.html">Go to Complete List &raquo;</a></p>\n<p class="user-toggle"><a class="show-recommended">Show My Recommendations</a></p>\n</footer>';return __p},templates.recommended=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",collection.length?(__p+="",isLoggedIn&&(__p+='<header class="recommendations-header">\n<div class="article-count"><span class="counter">'+(null==(__t=collection.getCount())?"":__t)+'</span> articles viewed recently</div>\n<div class="user-meta">\n',__p+=collection.getUserPictureUrl()?'\n<img class="avatar" src="'+(null==(__t=collection.getUserPictureUrl())?"":__t)+'" />\n':'\n<img class="avatar" src="http://i1.nyt.com/images/apps/timespeople/none.png" />\n',__p+='\n<span class="user-name">'+(null==(__t=collection.getUserDisplayName())?"":__t)+'</span><br />\n<a href="http://www.nytimes.com/recommendations">All Recommendations</a>\n</div>\n</header>'),__p+="<ol>",_.each(collection.slice(0,10),function(e){__p+='<li>\n<a class="story-link" href="'+(null==(__t=e.get("link"))?"":__t)+'">\n<article class="story">\n',e.getCrop("thumbStandard")&&(__p+='\n<div class="small-thumb">\n<img src="'+(null==(__t=e.getCrop("thumbStandard").url)?"":__t)+'" />\n</div>\n'),__p+="\n",e.get("kicker")&&(__p+='\n<h3 class="kicker">'+(null==(__t=e.get("kicker"))?"":__t)+"</h3>\n"),__p+='\n<h2 class="story-heading">\n'+(null==(__t=e.get("headline"))?"":__t)+"\n</h2>\n</article>\n</a>\n</li>"}),__p+="</ol>"):__p+='<p class="error-message">We don&rsquo;t have any personalized recommendations for you at this time. Please try again later.</p>',__p+='<footer class="recommendations-footer">',__p+=isLoggedIn?'<div class="user-actions">\n<p class="user-action"><a href="http://www.nytimes.com/recommendations">Go to Your Recommendations &raquo;</a></p>\n<ul class="menu layout-horizontal theme-links with-pipes">\n<li><a href="http://www.nytimes.com/content/help/extras/recommendations/recommendations.html">What&rsquo;s This?</a></li>\n<li><a class="hide-recommended">Don’t Show</a></li>\n</ul>\n</div><div id="recommendedAd" class="recommended-ad ad">\n<iframe scrolling="no" frameborder="0" src="http://www.nytimes.com/packages/html/recommendations/ad.html" width="168" height="40"></iframe>\n</div>':'<p class="user-message">Log in to discover more articles<br>based on what you&rsquo;ve read.</p><div id="recommendedAd" class="recommended-ad ad">\n<iframe scrolling="no" frameborder="0" src="http://www.nytimes.com/packages/html/recommendations/ad.html" width="168" height="40"></iframe>\n</div><div class="user-actions logged-out">\n<div class="user-tools-button-group">\n<button class="button login-button login-modal-trigger">Log In</button>\n<button class="button registration-button registration-modal-trigger">Register Now</button>\n</div>\n<ul class="menu layout-horizontal theme-links with-pipes">\n<li><a href="http://www.nytimes.com/content/help/extras/recommendations/recommendations.html">What&rsquo;s This?</a></li>\n<li><a class="hide-recommended">Don’t Show</a></li>\n</ul></div><!-- close user-actions -->',__p+="</footer>";return __p},templates}),define("shared/tabs/views/legacy/tabs",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/views/base-view"],function(e,t,s,i){var n=i.extend({activeTabClass:"selected",events:{"click .tabs li":"handleTabClick"},initialize:function(){t.bindAll(this,"handleTabClick");var e,s;this.$tabs=this.$el.find(".tabs li"),e=this.$tabs.filter(".selected"),this.$tabContent=this.$el.siblings(".tab-content"),this.resetState(),e.length>0?(s=e.eq(0).index(),this.activateTab(s)):this.activateTab(0)},handleTabClick:function(t){var s=e(t.currentTarget).closest("li");s.hasClass(this.activeTabClass)||t.preventDefault();var i=s.index();this.local(this,"nyt:tab-click",t,i),this.resetState(),this.activateTab(i)},activateTab:function(e){this.$tabs.eq(e).addClass(this.activeTabClass),this.$tabContent.eq(e).show()},resetState:function(){this.$tabs.removeClass(this.activeTabClass),this.$tabContent.hide()}});return n}),define("shared/data/instances/most-viewed",["jquery/nyt","foundation/views/page-manager","foundation/hosts","shared/data/collections/most-popular"],function(e,t,s,i){return new i([],{type:"mostviewed"})}),define("shared/recommendations/views/recommendations",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/views/base-view","foundation/models/user-data","foundation/cookies","shared/recommendations/templates","shared/tabs/views/legacy/tabs","shared/data/instances/most-emailed","shared/data/instances/most-viewed","shared/data/instances/recommendations"],function(e,t,s,i,n,a,o,l,r,d,c){var h=i.extend({el:"#recommendations",events:{"click .hide-recommended":"handleHideClick","click .show-recommended":"handleShowClick"},collectionList:{"most-emailed":{name:"mostEmailedCollection",render:"renderMostEmailed",instance:r},"most-viewed":{name:"mostViewedCollection",render:"renderMostViewed",instance:d},recommended:{name:"recommendedCollection",render:"renderRecommended",instance:c}},initialize:function(){this.$tabsContainer=this.$el.find(".tabs-container");var t=new l({el:this.$tabsContainer});this.subscribe(t,"nyt:tab-click",function(t){var s=e(t.currentTarget).data("type");this.handleTabClick(s)});var s=a.readCookie("nyt-recommend");"0"===s?this.deactivateRecommended():s&&"1"!==s||this.activateRecommended()},handleTabClick:function(e){var t=this.collectionList[e];this[t.name]=t.instance.loadData(),this[t.name].length>0?this[t.render]():this.subscribeOnce(this[t.name],"sync",this[t.render])},renderMostEmailed:function(){this.$el.find(".tab-content.most-emailed").html(o.mostPopular({collection:this.mostEmailedCollection}))},renderMostViewed:function(){this.$el.find(".tab-content.most-viewed").html(o.mostPopular({collection:this.mostViewedCollection}))},renderRecommended:function(){this.recommendedCollection.length>0?(this.$el.find(".tab-content.recommended").html(o.recommended({collection:this.recommendedCollection,isLoggedIn:n.isLoggedIn()})),this.broadcast("nyt:ads-new-placement","recommendedAd")):(this.deactivateRecommended(),this.$el.addClass("recommended-no-results"))},handleHideClick:function(e){e.preventDefault(),this.deactivateRecommended(),a.writeCookie("nyt-recommend","0")},handleShowClick:function(e){e.preventDefault(),this.activateRecommended(),a.writeCookie("nyt-recommend","1")},deactivateRecommended:function(){this.$tabsContainer.find("li[data-type=most-emailed]").trigger("click"),this.$tabsContainer.find("li[data-type=recommended]").hide(),this.$el.removeClass("recommended-active")},activateRecommended:function(){this.$tabsContainer.find("li[data-type=recommended]").show().trigger("click"),this.$el.addClass("recommended-active")}});return h}),define("shared/recommendations/instances/recommendations",["shared/recommendations/views/recommendations"],function(e){new e}),require(["topic/instances/ad-manager","topic/instances/sharetools","topic/instances/timeline","topic/instances/article-well","topic/instances/utils","shared/masthead/instances/masthead","shared/account/instances/account","shared/navigation/instances/navigation","shared/messaging/instances/messaging","shared/searchform/instances/search-form","shared/whatsnext/instances/whats-next","shared/recommendations/instances/recommendations"]);